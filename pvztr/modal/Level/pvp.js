'use strict';{let originForceSave=$User['TaskForceTimeSync'];$User['TaskForceTimeSync']=!![];let loadAccessTmpCallback=null,tmpSelectModal=null,connection=null,tmpSaver={'startNum':0x0,'selfOriTime':0x0,'opponentNow':0x0,'selfNow':0x0,'selfWin':![]};function chkOpen(g){return g['readyState']==='open'||g['readyState']===0x1;}let diyProps={'acceleration':{'img':'images/Props/PropsIcon/acc.webp','cost':0x64,'coolTime':0x5,'func'(){connection&&chkOpen(connection)&&connection['send']('/accZombie');}},'ice_wind':{'img':'images/Props/PropsIcon/ice_wind.webp','cost':0x113,'coolTime':0xf,'func'(){connection&&chkOpen(connection)&&connection['send']('/icewind');}},'drop_sculpture':{'img':'images/Props/PropsIcon/drop_sculpture.webp','cost':0x96,'coolTime':7.5,'func'(){connection&&chkOpen(connection)&&connection['send']('/drop_sculpture');}},'drop_zombies':{'img':'images/Props/PropsIcon/drop_zombies.webp','cost':0x190,'coolTime':0x1e,'func'(){connection&&chkOpen(connection)&&connection['send']('/dropzombies');}}},oDiyPropGUI={'Init'(){let g=Object['keys'](diyProps);this['PropKindNum']=g['length'],this['propsDom']=$('dPropsContent'),this['wrapDom']=this['propsDom']['querySelector']('#dWrap'),this['upDom']=$('dUP'),this['render'](),SetBlock(this['propsDom']),oEffects['Animate'](this['propsDom'],{'top':'600px'},0.225,'cubic-bezier(0.0,\x200.0,\x200.2,\x201)');},'render'(){const{propsDom:g,wrapDom:i,PropKindNum:c}=this,w=getBorderCanvasDom('images/Props/Shop/buttonSlot.png',0xa,0xa,c*0x5c+0xf,0x15);EditEle(w,null,null,g,{'id':'dBottomBar','onclick':this['show']['bind'](this)}),w['style']['left']='-30px';let I=![];i['onmouseenter']=()=>I=!![],i['onmouseleave']=()=>{oSym['addTask'](0x1f4,()=>!I&&this['hide']()),I=![];};let Q=0x0,k='',f=this;for(let G in diyProps){let z=diyProps[G],e='IconWrap_'+G,X=NewEle(e,'div','left:'+Q*0x5c+'px;',{'className':'IconWrap'},i);X['innerHTML']='<img\x20class=\x22dLatterIcon\x22\x20src=\x22images/Props/Shop/button.png\x22><canvas\x20class=\x22dCoolIcon\x22\x20height=\x2277\x22\x20width=\x2277\x22></canvas><img\x20class=\x22dFrontIcon\x22\x20src=\x27'+z['img']+'\x27><span\x20class=\x22dNumText\x22>'+z['cost']+'</span>',(z['DOM_FrontIcon']=X['querySelector']('.dFrontIcon'))['onclick']=function(F){f['getPropCard']['bind'](f)(G,F);},z['DOM_CoolIcon']=X['querySelector']('.dCoolIcon'),z['DOM_NumText']=X['querySelector']('.dNumText'),Q++;}i['style']['width']=Q*0x5c+'px',i['style']['left']='-30px',this['upDom']['style']['left']=Q*0x5c/0x2+0x44-0x9-0x1e+'px';},'drawCoolTimeCircle'(g,i){g['clearRect'](0x0,0x0,0x4d,0x4d),g['save'](),g['beginPath'](),g['strokeStyle']=i['color'],g['globalAlpha']=0.7,g['lineWidth']=i['r'],g['translate'](i['x'],i['y']),g['scale'](-0x1,0x1),g['translate'](-i['x'],-i['y']),g['arc'](i['x'],i['y'],i['r']/0x2,Math['PI']*0x3/0x2,Math['PI']*0x3/0x2+Math['PI']*0x2*i['percent'],![]),g['stroke'](),g['restore']();},'beginCool'(g){let i=diyProps[g]['coolTime']*0x64,c=i,w=this['drawCoolTimeCircle'],I=diyProps[g]['DOM_CoolIcon'],Q=I['getContext']('2d');SetStyle(I,{'display':'block','opacity':0x1}),function k(){c=Math['max'](c-0xa,0x0),c>0x0?(w(Q,{'x':38.5,'y':38.5,'r':33.5,'percent':c/i,'color':'black'}),oSym['addTask'](0xa,k)):(w(Q,{'x':38.5,'y':38.5,'r':33.5,'percent':0x1,'color':'white'}),oEffects['Animate'](I,{'opacity':0x0},0.5,'linear',SetNone));}();},'getPropCard'(g,i){const c=diyProps[g],w=diyProps[g]['DOM_CoolIcon'],I=w['getContext']('2d');let Q=w['style']['cssText'];SetStyle(w,{'display':'block','opacity':0x1}),this['drawCoolTimeCircle'](I,{'x':38.5,'y':38.5,'r':33.5,'percent':0x1,'color':'black'}),oS['SunNum']>=c['cost']?(oS['SunNum']-=c['cost'],c['func'](),this['beginCool'](g)):(SunNumWarn(),w['style']['cssText']=Q);},'show'(){const g=this['upDom'];if(GetStyle(g,'opacity')!=='1')return;oEffects['Animate'](g,{'opacity':0.03},0.2),oEffects['Animate'](this['wrapDom'],{'top':'-70px','height':'70px','pointer-events':'auto'},0.3,'ease-in-out',i=>{g['style']['opacity']=0x0;});},'hide'(){const g=this['upDom'];if(GetStyle(g,'opacity')!=='0')return;oEffects['Animate'](this['wrapDom'],{'top':0x0,'height':0x0,'pointer-events':'none'},0.3,'ease-in-out',i=>{oEffects['Animate'](g,{'opacity':0.97},0.2,'linear',c=>{g['style']['opacity']=0x1;});});}};function processCommand(g){let c=null;if(g[0x0]==='/')switch(g){case'/selectingCard':loadAccessTmpCallback&&(ClearChild($('theRecieverWaitingBox'),$('____TMPBACKTOMENU')),loadAccessTmpCallback(),loadAccessTmpCallback=null);break;case'/startgame':++tmpSaver['startNum']===0x2&&startGameFunc();break;case'/exit':alert($__language_Array__['51e3a13febd53f804621d8932491dca2']);connection&&chkOpen(connection)&&connection['close']();tmpSelectModal(oS['Lvl']);break;case'/lose':tmpSaver['selfWin']=!![],toWin();break;case'/drawGame':toWin();break;case'/icewind':oMiniGames['IceStorm'](0x1,oS['R'],0x3);break;case'/dropzombies':oP['FlagToSumNum']['a2'][oP['FlagZombies']+0x1]=Math['max'](oP['FlagToSumNum']['a2'][oP['FlagZombies']+0x1]*1.7,0x1);for(let w=0x0;w<Math['min'](0xa,oP['FlagZombies']+0x1);w++){oSym['addTask'](Math['random']()*0x12c,()=>{PlaceZombie([oZombie,oConeheadZombie,oBucketheadZombie]['random'](),[0x1,0x2,0x3,0x4,0x5]['random'](),0xb,0x0);});}break;case'/drop_sculpture':{let I=hasPlants(!![],Q=>{return Q['isPlant']&&Q['C']>0x1;});if(I['length']>0x0){let Q=I['random'](),k=PlaceZombie(oSculpture,Q['R'],Q['C'],0x0,0x1);EditCompositeStyle({'ele':k['EleBody'],'delFuncs':['translateY'],'addFuncs':[['translateY','-600px']],'option':0x2}),oEffects['Animate'](k['EleBody'],{'transform':EditCompositeStyle({'ele':k['EleBody'],'delFuncs':['translateY']})},0.2/oSym['NowSpeed']);}else connection&&chkOpen(connection)&&connection['send']('addSun\x20'+diyProps['drop_sculpture']['cost']);}break;case'/accZombie':{for(let f of $Z){f&&!f['isPuppet']&&f['HP']>0x0&&f['getExcited'](1.15);}}}else{if((c=g['split']('\x20'))['length']===0x2)switch(c[0x0]){case'setSaver':Object['assign'](tmpSaver,JSON['parse'](c[0x1]));break;case'addZombiePoint':{let G=Number['parseFloat'](c[0x1]);oP['FlagToSumNum']['a2'][oP['FlagZombies']+0x1]=Math['max'](oP['FlagToSumNum']['a2'][oP['FlagZombies']+0x1]+G,0x1),oP['FlagToSumNum']['a2'][oP['FlagZombies']+0x2]=Math['max'](oP['FlagToSumNum']['a2'][oP['FlagZombies']+0x2]+G/0x2,0x1),oP['FlagToSumNum']['a2'][oP['FlagZombies']+0x3]=Math['max'](oP['FlagToSumNum']['a2'][oP['FlagZombies']+0x3]+G/0x4,0x1);}break;case'addSun':{oS['SunNum']+=Number['parseInt'](c[0x1])||0x0;}}}}function startGameFunc(){oAudioManager['playMusic'](oS['StartGameMusic']),SetVisible($('tdShovel'),$('dFlagMeter'),$('dTop')),CSpeed(0x1),oFlagContent['init']({'HeadType':'NoneHead','fullValue':0x64*0x168,'curValue':0x64*0x168}),PrepareGrowPlants(I=>{oP['Monitor'](),BeginCool(),AutoProduceSun(0x32),oSym['addTask'](0x258,Q=>{oP['AddZombiesFlag'](),oFlagContent['show'](),oDiyPropGUI['Init']();});});let g=null;tmpSaver['selfOriTime']=oSym['Now'],addEventListenerRecord('jng-event-startgame',()=>{new MutationObserver(I=>{IsGaming(0x1)&&I['forEach'](Q=>{Q['removedNodes']['forEach'](function k(f){let G=f['id'],z=window[f['dataset']['jngConstructor']];if(!z)return;let e=z['prototype'],X=e['EName'];if(G['includes']('Z_0.'))!isNaN(e===null||e===void 0x0?void 0x0:e['Lvl'])&&(g===null&&(g=0x0,i()),g+=e['Lvl']/2.2);else e['isPlant']&&!e['Tools']&&(g===null&&(g=0x0,i()),g-=0.6);});});})['observe'](EDPZ,{'childList':!![],'subtree':!![]});});function i(){oSym['addTask'](0x64,()=>{connection['send']('addZombiePoint\x20'+g),g=null;});}oSym['addTask'](0x64*0x168,()=>{toWin(),connection['send']('/drawGame');}),w();let c=$('sFlagMeterTitleF');function w(){oP['FlagZombies']>=0x1&&(c['innerText']=$__language_Array__['88b6ee5048857426a1927e08ac56c0c3']+Math['floor']((oP['FlagToSumNum']['a2'][oP['FlagZombies']-0x1]+oP['FlagToSumNum']['a2'][oP['FlagZombies']]+oP['FlagToSumNum']['a2'][oP['FlagZombies']+0x1])/0x3)),oFlagContent['update']({'MeterType':'LeftBar\x20RedBar','curValue':0x64*0x168-(oSym['Now']-tmpSaver['selfOriTime']),'animConfig':{'disabled':!![]}}),oSym['addTask'](0x12c,w);}}let PArr=[oPeashooter,oSunFlower,oPotatoMine,oWallNut,oStoneFlower,oSnowPea,oRepeater,oRadish,oTallNut,oCherryBomb,oSquash,oFlowerPot,oSunShroom,oPuffShroom,oScaredyShroom,oFumeShroom,oSporeShroom,oBegonia,oPepper,oIceAloe,oImitater,oSpikeweed,oTorchwood,oKiwibeast,oCabbage,oBlover,oShiitake,oKernelPult,oCranberry,oMelonPult,oElecTurnip,oUmbrellaLeaf,oEichhornia,oIceShroom],ZArr=[oZombie,oConeheadZombie,oBucketheadZombie,oNewspaperZombie,oBalloonZombie,oStrollZombie,oFootballZombie,oCigarZombie,oCaskZombie,oSadakoZombie,oImp,oMembraneZombie,oMakeRifterZombie,oSkatingZombie,oPushIceImp,oZomboni,oSculptorZombie,oBeetleCarZombie,oThiefZombie,oGargantuar,oPeashooterZombie,oWallNutZombie,oJalapenoZombie],AZRandom=((()=>{let g=[],c=ZArr['concat']([])['shuffle'](),w=0x0,I=0x0,Q=0x0,f=0x0;for(let G of c){let z=G['prototype']['Lvl'];if(z<0x2&&w<0x4)w++,g['push']([G,Math['random']()*0x2+1.6,0x1]);else{if(z<0x6&&I<0x4)I++,g['push']([G,Math['random']()*0x3+1.2,Math['round'](Math['random']()*0x7+0x4)]);else{if(z<0xa&&Q<0x3)Q++,g['push']([G,Math['random']()*0x2+0x1,Math['round'](Math['random']()*0x7+0x8)]);else f<0x3&&(f++,g['push']([G,0x1,Math['round'](Math['random']()*0x7+0xc)]));}}}return g;})());oS['Init']({'PName':PArr,'ZName':AllCommonZombiesArr,'PicArr':['images/interface/background1.webp'],'DKind':0x1,'SunNum':0x12c,'CoinRatio':1.2,'SpawnLevelLimit':0.67,'ControlFlagmeter':![],'backgroundImage':'images/interface/background1.webp','backgroundMask':'BgMask-Tutorial','LevelName':$__language_Array__['f01194f1a475bbdb5a9f7d239c5e051a'],'LoadMusic':'Bgm_Tutorial_Ready','StartGameMusic':'Bgm_Pvp','FixedProps':'disabled','LoadAccess':function(g){SetHidden($('dMenu0'));let i=g;g=()=>{i();for(let f=0x0;f<0x3e8;f++){oP['FlagToSumNum']['a1'][f]=f+0x1,oP['FlagToSumNum']['a2'][f]=Math['Clamp'](Math['ceil'](f/0x2),0x1,0x24);}};{let f=toOver,G=Exitlevel;RewriteGlobalVariables({'Exitlevel'(...e){z(),G(...e),console['log'](connection,connection['readyState']),connection&&chkOpen(connection)&&(connection['send']('/exit'),connection['close']()),$User['TaskForceTimeSync']=originForceSave;},'toOver'(...e){PlaySubtitle($__language_Array__['e39d922aad2c0a67a2ee07aa695604df']),PauseGame(),connection&&chkOpen(connection)&&(connection['send']('/lose'),connection['close']()),setTimeout(()=>{tmpSelectModal(oS['Lvl']);},0xbb8);}},![]),tmpSelectModal=(...e)=>{z(),connection&&chkOpen(connection)&&(connection['send']('/exit'),connection['close']()),SelectModal(...e),$User['TaskForceTimeSync']=originForceSave;};function z(){$('dMenu0')['style']['visibility']='',oMenu['canPauseGame']=!![];}}oP['DefaultFlagTime']=0x320,loadAccessTmpCallback=g;let c=NewEle('','div','position:absolute;left:0;top:0;width:100%;height:100%;z-index:998',{},EDAll),w=NewEle('','a','position:absolute;left:0;top:0;color:white;font-size:48px;z-index:999',{'innerText':$__language_Array__['0418bb4abeb4c9702504e37ac17f7624']},c),I=NewEle('','a','position:absolute;right:0;top:0;color:white;font-size:48px;z-index:999',{'innerText':$__language_Array__['65279bbf07e9db84291b8055fe0c0e31']},c),Q=NewEle('____TMPBACKTOMENU','a','position:absolute;bottom:0;right:0;color:white;font-size:48px;z-index:999',{'innerText':$__language_Array__['2a5675c176bc6d63f527ef52c9f3a72e'],'onclick'(){tmpSelectModal('AS_Room/Room.js');}},EDAll),k=NewEle('','input','position:absolute;right:50%;top:0;transform:translateX(50%);z-index:999',{'placeholder':$__language_Array__['68488d7191816f502c240f6a20a9dd5d']},c);k['onchange']=function(){let e=new WebSocket('ws://'+k['value']);e['onopen']=()=>{connection=e,ClearChild(c),e['addEventListenerRecord']('message',X=>{e&&chkOpen(e)&&processCommand(X['data']);});};},w['onclick']=()=>{ClearChild(c,Q);function e(...x){x['forEach'](r=>{r['oncopy']=r['oncontextmenu']=r['onselectstart']=r['onmousedown']=function(t){t['stopPropagation']();},r['style']['userSelect']='text';});}const X=new RTCPeerConnection();let F=![],H=![],W=X['createDataChannel'](Math['random']());W['onmessage']=x=>{console['log']('Got\x20a\x20message:'+x['data']),processCommand(x['data']);},W['onopen']=x=>{console['log']('Connection\x20opened!'),!H&&(W['send']('/selectingCard'),g()),H=!![];},connection=W,X['onicecandidate']=x=>{console['log']('New\x20Ice\x20Candidate!\x20My\x20SDP\x20:\x20'+JSON['stringify'](X['localDescription']));if(!F){alert($__language_Array__['7e66d7f3df6b2dcda35e39c206f5ebf6']);let r=NewEle('','center','left:0;top:0;position:absolute;width:100%;cursor:text;height:100%;background:rgba(0,0,0,0.4);font-size:20px;color:white;z-index:1000;',{'innerText':JSON['stringify'](X['localDescription'])+'\x0a'},EDAll);e(r),NewEle('','button','cursor:pointer;font-size:24px;',{'innerText':$__language_Array__['cc89861adac6f3b09c32ad496a9399d0'],'onclick'(){ClearChild(r),setTimeout(function(){let t=JSON['parse'](prompt($__language_Array__['a15756206e3e5349ca265eb0258eefa9']));X['setRemoteDescription'](t),setTimeout(function(){!H&&(alert($__language_Array__['3f64cea3ba08c5cf67bc86bf5a9c2e24']),tmpSelectModal(oS['Lvl']));},0x7530);},0xa);}},r),F=!![];}},X['createOffer']()['then'](x=>X['setLocalDescription'](x))['then'](x=>{console['log']('set\x20successfully!');});},I['onclick']=()=>{ClearChild(c,Q);function e(...x){x['forEach'](r=>{r['oncopy']=r['oncontextmenu']=r['onselectstart']=r['onmousedown']=function(t){t['stopPropagation']();},r['style']['userSelect']='text';});}let X=![],F=![],H=null;try{H=JSON['parse'](prompt($__language_Array__['8e79e4aeca9528a3ac5daa63c25548e2']));if(H['length']===0x0)throw'No\x20Length';}catch{alert($__language_Array__['2c091692b1ad39b5c28f9f2b359ca5c3']),tmpSelectModal(oS['Lvl']);};const W=new RTCPeerConnection();W['onicecandidate']=x=>{console['log']('New\x20Ice\x20Candidate!\x20My\x20SDP\x20:\x20'+JSON['stringify'](W['localDescription']));if(!X){alert($__language_Array__['2282134d96729ce2c632030885bec484']);let r=NewEle('theRecieverWaitingBox','center','left:0;top:0;position:absolute;width:100%;cursor:text;height:100%;font-size:20px;background:rgba(0,0,0,0.4);color:white;z-index:1000;',{'innerText':JSON['stringify'](W['localDescription'])+'\x0a'},EDAll);NewEle('','button','cursor:pointer;font-size:24px;',{'innerText':$__language_Array__['c96c6760fb085930f0929abb3b77e813'],'onclick'(){tmpSelectModal(oS['Lvl']);}},r),e(r),X=!![];}},W['ondatachannel']=x=>{connection=W['dc']=x['channel'],W['dc']['onmessage']=r=>{console['log']('new\x20message\x20from\x20client!'+r['data']),processCommand(r['data']);},W['dc']['onopen']=r=>{console['log']('Connection\x20Opened!');};},W['setRemoteDescription'](H)['then'](x=>console['log']('offer\x20set!')),W['createAnswer']()['then'](x=>W['setLocalDescription'](x))['then'](x=>console['log']('answer\x20created'));};},'StartGame':function(){oMenu['canPauseGame']=![],++tmpSaver['startNum']===0x2?startGameFunc():PlaySubtitle($__language_Array__['23b1dcac6476bebd08fd1281c1a421a2'],0x12c),connection['send']('/startgame');}},{'AZ':AZRandom,'FlagNum':0x3e8,'FlagToSumNum':{'a1':[0x3e8],'a2':[0x0]},'FlagToEnd':function(){oP['FlagToEnd']=()=>{},tmpSaver['selfWin']?PlaySubtitle($__language_Array__['1ef3854c0a517c207a1791509b088324']):PlaySubtitle($__language_Array__['ab905c76bc9950785b58dd811f09d7ba']),connection&&chkOpen(connection)&&connection['close'](),setTimeout(function(){tmpSelectModal(oS['Lvl']);},0xbb8);}});}