'use strict';var _navigator$language$i,_navigator$language;const BlankPNG='data:image/webp;base64,UklGRkAAAABXRUJQVlA4WAoAAAAQAAAAAAAAAAAAQUxQSAIAAAAAAFZQOCAYAAAAMAEAnQEqAQABAAFAJiWkAANwAP789AAA',EBody=document['body'],EElement=document['documentElement'],RESPATH='images/interface/',dSurface=$('dSurface'),PKindUpperLimit=0x5,PKindTraverseOrder=[0x5,0x0,0x1,0x2,0x3,0x4],GrowSoilImg='images/interface/GrowSoil.webp',WaterShadowImg='images/Zombies/WaterShadow.webp',WaterSplashImg='images/Zombies/Drop_Water.webp',EVENT_STARTGAME=new Event('jng-event-startgame'),EVENT_ENDGAME=new Event('jng-event-endgame'),EVENT_EXITGAME=new Event('jng-event-exitgame');let $User={'NowStep':0x1,'TimeStep':0xa,'AutoSun':Number(localStorage['JNG_TR_AUTOSUN'])||![],'Tag':localStorage['tag']?localStorage['tag']:'local','Name':localStorage['name']?localStorage['name']:'local','LowPerformanceMode':![],'Async_GIFS_Animate':!![],'Coins':0x0,'Achievement':localStorage['JNG_TR_Achievement']?JSON['parse'](localStorage['JNG_TR_Achievement']):{},'enabledWallNutFirstAid':isNullish(localStorage['JNG_TR_WallNutFirstAid'])?![]:!![],'enabledSunShovel':!isNullish(localStorage['JNG_TR_SunShovel'])&&localStorage['JNG_TR_EnabledItems']&&JSON['parse'](localStorage['JNG_TR_EnabledItems'])['SunShovel']===0x1?!![]:![],'enabledMoreStartingSun':!isNullish(localStorage['JNG_TR_MoreStartingSun'])&&localStorage['JNG_TR_EnabledItems']&&JSON['parse'](localStorage['JNG_TR_EnabledItems'])['MoreStartingSun']===0x1?!![]:![],'DrawBlood':localStorage['JNG_TR_DrawBlood']?JSON['parse'](localStorage['JNG_TR_DrawBlood']):![],'TaskForceTimeSync':localStorage['JNG_TR_TaskForceTimeSync']?JSON['parse'](localStorage['JNG_TR_TaskForceTimeSync']):!![],'OpenDynamicDifficulty':(_navigator$language$i=(_navigator$language=navigator['language'])===null||_navigator$language===void 0x0?void 0x0:_navigator$language['includes']('zh'))!==null&&_navigator$language$i!==void 0x0?_navigator$language$i:![],'IS_PLOT_OPEN':localStorage['JNG_TR_IS_PLOT_OPEN']?JSON['parse'](localStorage['JNG_TR_IS_PLOT_OPEN']):!localStorage['JNG_DEV'],'AudioEffectVolumePercent':localStorage['JNG_TR_AudioPercent']?Number['parseFloat'](localStorage['JNG_TR_AudioPercent']):0x1,'MusicVolumePercent':localStorage['JNG_TR_MusicPercent']?Number['parseFloat'](localStorage['JNG_TR_MusicPercent']):0x1,'_tmpARCARD':{}};class __oSymTaskPool__{constructor(){this['taskPool']=[];}['get'](g,i,c,w){var I;let Q=(I=this['taskPool']['pop']())!==null&&I!==void 0x0?I:{};return Q['T']=g,Q['f']=i,Q['taskIndex']=c,Q['ar']=w,Q;}['recycle'](g){return delete g['f'],delete g['ar'],this['taskPool']['push'](g),g;}};const oSym={'ZMonitorRefresh':0x64,'BuMonitorRefresh':0xa,'Init'(g,i=[]){var c;const w=this;w['Rewrite'](w),w['Now']=0x0,w['Timer']=null,w['TQ']=[],w['TQSet']=new Set(),w['NowStep']=0x1,w['TimeStep']=0xa,w['changed']=Infinity,w['taskNum']=0x0,w['taskTotal']=0x0,w['NowSpeed']=0x1,w['__IncreasedTime__']=null,w['__pool__']=(c=w['__pool'])!==null&&c!==void 0x0?c:new __oSymTaskPool__(),$User['NowSpeed']&&CSpeed($User['NowSpeed'],![]),w['addTask'](0x0,g,i),w['Start']();},'CalcTimePassed'(g){return Math['min'](g,0x64);},'Rewrite'(g){!$User['TaskForceTimeSync']?(g['Start']=()=>{if(g['Timer']===null){let i,c,w=g['NowStep'],I=Date['now'](),Q,k=g['TQ'];const f=g['TimeStep'],G=g['TQSet'],z=g['__pool__'],e=()=>{c=g['Now']+=w;(g['changed']-=w)<0x1&&g['Resort'](g);for(let X=g['taskNum']-0x1;X>=-0x1;--X){i=k[X];if(X===-0x1||c<i['T']){g['taskNum']=X+0x1;break;}if(i['T']===-Infinity){localStorage['JNG_DEV']==='true'&&console['warn']('[PvZTR]\x20-Infinity\x20Task',Object['assign']({},i));continue;}try{i['f'](...i['ar']),i['T']=-Infinity;}catch(F){console['error'](F);}}G['forEach'](H=>{if(c>=H['T']){try{H['f'](...H['ar']);}catch(W){console['error'](W);}G['delete'](z['recycle'](H));}});};g['Timer']=setInterval(e,g['TimeStep']);}},g['addTask']=(i=0x0,c,w=[],I=![])=>{const Q=this,k=Q['__pool__']['get'](Q['Now']+i,c,Q['taskTotal']++,w);return i<0xf||I?Q['TQSet']['add'](k):(Q['TQ']['push'](k),Q['changed']=Math['min'](Q['changed'],i)),k;}):(g['Start']=()=>{if(g['Timer']===null){let i,c,w,I=Date['now'](),Q,k=g['TQ'];const f=g['TQSet'],G=g['__pool__'],z=()=>{Q=Date['now'](),w=Math['max'](g['CalcTimePassed'](Q-I)*g['NowSpeed']/0xa,0x0),I=Q,c=g['Now']+=w;(g['changed']-=w)<0x1&&g['Resort'](g);for(let X=g['taskNum']-0x1;X>=-0x1;--X){i=k[X];if(X===-0x1||c<i['T']){g['taskNum']=X+0x1;break;}if(i['T']===-Infinity){localStorage['JNG_DEV']==='true'&&console['warn']('[PvZTR]\x20-Infinity\x20Task',Object['assign']({},i));continue;}try{g['__IncreasedTime__']=i['T']-g['Now'],i['f'](...i['ar']),i['T']=-Infinity;}catch(F){console['error'](F);}}f['forEach'](H=>{if(c>=H['T']){try{g['__IncreasedTime__']=H['T']-g['Now'],H['f'](...H['ar']);}catch(W){console['error'](W);}f['delete'](G['recycle'](H));}}),g['__IncreasedTime__']=null;};let e=g['Timer']=Math['random']();requestAnimationFrame(function X(){if(g['Timer']!==e)return;z(),requestAnimationFrame(X);});}},g['addTask']=(i=0x0,c,w=[],I=![])=>{var Q;const k=this;i+=(Q=k['__IncreasedTime__'])!==null&&Q!==void 0x0?Q:0x0;const f=k['__pool__']['get'](k['Now']+i,c,k['taskTotal']++,w);return i<0xf||I?k['TQSet']['add'](f):(k['TQ']['push'](f),k['changed']=Math['min'](k['changed'],i)),f;});},'Resort'(g){const i=g['TQ'],c=g['__pool__'];g['changed']=Infinity,i['sort']((w,I)=>{return I['T']-w['T']||I['taskIndex']-w['taskIndex'];}),g['taskNum']=i['length'];while(g['taskNum']--){if(i[g['taskNum']]['T']!==-Infinity)break;c['recycle'](i['pop']());}g['taskNum']++;},'removeTask'(g){!this['TQSet']['delete'](g)&&(g['T']=-Infinity);},'Stop'(){clearInterval(oSym['Timer']),oSym['Timer']=null;},'Clear'(){this['TQ']['length']=0x0,this['TQSet']['clear'](),this['taskNum']=0x0,this['taskTotal']=0x0;},'Sleep'(g){return new Promise(i=>oSym['addTask'](g,i));}},LevelConfig={'config':{'Tutorial':{'backgroundMask':'BgMask-Tutorial','SummonZombieArea':[undefined,undefined,0x96]},'Forest':{'backgroundImage':'images/interface/Forest.webp','backgroundMask':'BgMask-Forest','AllowUserCard':!![],'DynamicDifficulty':!![],'CoinRatio':0x1,'SummonZombieArea':[undefined,0xa0,0x64,0x172]},'Forestjx':{'backgroundImage':'images/interface/ForestJx.webp','backgroundMask':'BgMask-Forest','AllowUserCard':!![],'CoinRatio':1.5,'SummonZombieArea':[undefined,0xa0,0x64,0x172]},'Marsh':{'backgroundImage':'images/interface/Marsh.webp','backgroundMask':'BgMask-Marsh','LoadMusic':'Bgm_Marsh_Ready','StartGameMusic':'Bgm_Marsh_Fight','DKind':0x0,'DynamicDifficulty':!![],'AllowUserCard':!![],'CoinRatio':0x1,'SpawnLevelLimit':0.6},'Marshjx':{'backgroundImage':'images/interface/MarshJx.webp','backgroundMask':'BgMask-Marsh','AllowUserCard':!![],'CoinRatio':1.5},'Polar':{'backgroundMask':'BgMask-Polar',get'DKind'(){return oS['Lvl']['replace'](/[^0-9]/ig,'')<=0xf?0x1:0x0;},get'SunNum'(){return oS['DKind']?0x96:0x12c;},get'LoadMusic'(){return'Bgm_Polar_Ready_'+(oS['DKind']?0x1:0x2);},get'StartGameMusic'(){return'Bgm_Polar_Fight_'+(oS['DKind']?0x1:0x2+Math['round'](Math['random']()*0x2));},get'backgroundImage'(){return'images/interface/Polar'+(oS['DKind']?'':'2')+'.webp';},get'LoadAccess'(){return g=>{oAudioManager['playAudio']('Bgm_Polar_Noise',0x1),!oS['DKind']&&(NewEle('PolarFire2','span',null,{'className':'PolarFire'},$('tGround')),NewEle('PolarFire','span',null,{'className':'PolarFire'},$('tGround'))),oSym['addTask'](0x5a,g);};},'DynamicDifficulty':!![],'AllowUserCard':!![],'CoinRatio':0x1,'SummonZombieArea':[0x46,0xbe,0xf0,0x172]},'Polarjx':{'backgroundMask':'BgMask-Polar',get'DKind'(){return oS['Lvl']['replace'](/[^0-9]/ig,'')<=0xf?0x0:0x1;},get'SunNum'(){return oS['DKind']?0x96:0x12c;},get'backgroundImage'(){return'images/interface/Polar'+(oS['DKind']?'':'2')+'.webp';},'SummonZombieArea':[0x46,0xbe,0xf0,0x172],'ZombieRandomSpeed':0x0,'AllowUserCard':!![],'CoinRatio':1.5},'Industry':{'PicArr':(function(){let g=['images/interface/Industry.webp'];for(let c=0x0;c<0x4;c++){g['push']('images/interface/haze'+c+'.png'),g['push']('images/interface/fog'+c+'.png');}return g;}()),'backgroundImage':'images/interface/Industry.webp','LoadMusic':'Bgm_Industry_Ready','AllowUserCard':!![],'backgroundMask':'BgMask-Industry',get'StartGameMusic'(){return oS['Lvl']['replace'](/[^0-9]/ig,'')<0x15?'Bgm_Industry_Fight':'Bgm_Industry_Fight_2';},'LoadAccess'(g){oSym['addTask'](0x5a,g);},get'DynamicDifficulty'(){return oS['Lvl']['replace'](/[^0-9]/ig,'')<0x13?!![]:![];},'CoinRatio':1.5,'SummonZombieArea':[undefined,undefined,0x96]},'Industryjx':{'PicArr':['images/interface/Industryjx.webp'],'backgroundImage':'images/interface/Industryjx.webp','LoadMusic':'Bgm_Industry_Ready_JX','backgroundMask':'BgMask-Industry','AllowUserCard':!![],'DKind':0x0,get'StartGameMusic'(){return'Bgm_Industry_Fight_JX';},'LoadAccess'(g){oSym['addTask'](0x5a,g);},'CoinRatio':1.7,'SummonZombieArea':[undefined,undefined,0x96]},'Mirage':{'PicArr':['images/interface/Mirage.webp','images/interface/Mirage_Night.webp','images/Props/WaterPath/edgeMask.webp','images/Props/WaterPath/fullWater.webp','images/interface/Tombstone.webp'],'LoadMusic':'Bgm_Mirage_Ready','AllowUserCard':!![],'backgroundMask':'BgMask-Mirage','DKind':0x1,get'StartGameMusic'(){return'Bgm_Mirage_Fight';},get'backgroundImage'(){return'images/interface/Mirage'+(oS['DKind']?'':'_Night')+'.webp';},'LoadAccess'(g){oSym['addTask'](0x5a,g);},'CoinRatio':0x2,'SpawnLevelLimit':0.7,'SummonZombieArea':[undefined,undefined,0x96]},'SeasonA':{'backgroundImage':'images/interface/Fuben_Autumn.webp','backgroundMask':'BgMask-Forest','LF':[0x0,0x1,0x1,0x3,0x1,0x1],'CoinRatio':1.2,'LoadMusic':'Fuben_Autumn_Ready','AllowUserCard':!![],'StartGameMusic':'Fuben_Autumn_Fight','SummonZombieArea':[undefined,0xa0,0x64,0x172]},'SeasonW':{'backgroundImage':'images/interface/Fuben_Winter.webp','backgroundMask':'BgMask-Polar','LoadMusic':'Fuben_Winter_Ready','StartGameMusic':'Fuben_Winter_Fight','SunNum':0xc8,'CoinRatio':1.2,'DKind':0x0,'AllowUserCard':!![],'SummonZombieArea':[0x46,0xb4,0xf0,0x172]}},'query'(){let g=(''+oS['Lvl'])['replace'](/[^a-zA-Z]+/g,'');if(this['config'][g])return this['config'][g];return{};}},oS={'W':0x42b,'GroundW':0x384,'EDAllScrollLeft':0x0,'GroundPictureWidth':0x578,'FightingSceneLeft':0x73,'H':0x258,'C':0x9,'LawnMowerX':0x46,'Lvl':0x0,'PlantOrder':0x1,'DefaultStartGame'(){oAudioManager['playMusic'](oS['StartGameMusic']),SetVisible($('tdShovel'),$('dFlagMeter'),$('dTop')),oS['ControlFlagmeter']&&oFlagContent['init']({'fullValue':oP['FlagNum']-0x1,'curValue':0x0}),oS['InitLawnMover'](),PrepareGrowPlants(g=>{oP['Monitor'](),BeginCool(),AutoProduceSun(0x32),oSym['addTask'](0x5dc,i=>{oP['AddZombiesFlag'](),oS['ControlFlagmeter']&&oFlagContent['show']();});});},'DefaultFlagToEnd'(g=null){ShowWinItem(NewImg('imgSF','images/interface/Clearance_reward.png','left:535px;top:200px;width:116px;height:119px;',EDAll,{'onclick':i=>oS['Lvl']['indexOf']('jx')<0x0?GetNewProp(i['target'],'Clearance_reward',$__language_Array__['39e48d7169def8d11f6bfab216eb7455'],$__language_Array__['d28efa2f99e9c27571354eccb0991caf'],g!==null&&g!==void 0x0?g:NextLevel(),'30%','387px'):GetWin(i['target'],g!==null&&g!==void 0x0?g:Exitlevel(oS['Lvl'],0x1))}));},'GlobalVariables':{},'warmStart':0x0,'Init'(g,c,w){const I=this;for(let e in w){I['GlobalVariables'][e]=window[e],window[e]=w[e];}window['ArCard']=[],window['ArPCard']={'SelNum':0x0,'$':{}},window['ArSun']={},window['$Z']={},window['$P']={},window['EDAll']=$('dAll'),window['EDAlloffsetLeft']=EDAll['offsetLeft'],window['FightingScene']=$('dFightingScene'),window['Ground']=$('tGround'),window['EDPZ']=$('dPZ'),window['EDPZ_Spare1']=$('dPZ_Spare1'),window['EDPZ_Spare2']=$('dPZ_Spare2'),window['EDNewAll']=EDAll['cloneNode'](!![]),window['ESSunNum']=$('sSunNum'),window['IsGaming']=X=>!!((X?oGd===null||oGd===void 0x0?void 0x0:oGd['$']['4_-2_1']:oS['PName']['length']>0x0)&&oSym['Timer']);const Q={'PicArr':[],'DynamicPicArr':[],'AudioArr':[],'MusicArr':[],'VideoArr':[],'Coord':0x1,'LF':[0x0,0x1,0x1,0x1,0x1,0x1],'ZF':null,'PName':[],'LoadingPName':[],'ZName':[],'SunNum':0x96,'backgroundImage':null,'backgroundMask':null,'isScroll':!![],'InitLawnMover':null,'InitWaterPath':null,'SummonZombieArea':[],'HaveFog':null,'FixedProps':{},'ProduceSun':!![],'AllowUserCard':![],'SortCardType':0x1,'StaticCard':0x1,'DynamicDifficulty':![],'ZombieRandomSpeed':0.15,'ControlFlagmeter':!![],'CanSelectCard':!![],'DKind':0x1,'LoadAccess':null,'PicNum':0x0,'AccessNum':0x0,'MCID':null,'Chose':0x0,'isStartGame':0x0,'CoinRatio':0x0,'ChoseCard':'','MPID':'','CardsType':{},'SpawnLevelLimit':0x0,'autoWaterFlowDirection':!![],'changeDKindConfig':{},'TombConfig':null,'__BalancedPlant__':![],'observeZombieLayer':![],'LvlToken':''+Math['random']()};I['SelfVariables']=new Set(Object['keys'](g)['concat'](Object['keys'](Q))),I['SunNum']=null,Object['assign'](I,g),Object['assignWithoutOverwrite'](I,LevelConfig['query'](),Q);if(![]&&I['__BalancedPlant__']){__TEST_REWRITE_BALANCED_PLANTS__();for(let X=0x0;X<oS['PName']['length'];X++){var k;oS['PName'][X]=(k=window[oS['PName'][X]['prototype']['EName']])!==null&&k!==void 0x0?k:oS['PName'][X];}}!I['ZF']&&(I['ZF']=I['LF']),I['LoadMusic']&&I['warmStart']&&oAudioManager['playMusic'](I['LoadMusic']),I['MusicArr']=(oS['StartGameMusic']?[oS['StartGameMusic']]:[])['concat'](I['MusicArr']);if(I['PName']['length']>0x0&&I['StaticCard']&&I['CanSelectCard']){let F={};for(let x=0x0;x<I['PName']['length'];x++){F[I['PName'][x]['prototype']['EName']]=0x989680+x;}let H={};if(I['AllowUserCard']){var f;let r=JSON['parse']((f=localStorage['JNG_TR_GotPlants'])!==null&&f!==void 0x0?f:'[]'),t=r['map'](U=>window[U]);I['PName']=I['PName']['concat'](t)['unique']();if(I['SortCardType']===0x0){let U=AllPlantsENameArr['getValueIndexedJson'](),u=r['getValueIndexedJson']();for(let O=0x0;O<I['PName']['length'];O++){let D=I['PName'][O]['prototype']['EName'];if(u[D]){var G;H[D]=(G=U[D])!==null&&G!==void 0x0?G:0x989680+O;}else{var z;H[D]=(z=U[D])!==null&&z!==void 0x0?z:O;}}}}if(I['SortCardType']===0x1)for(let V=0x0;V<AllPlantsENameArr['length'];V++){H[AllPlantsENameArr[V]]=V;}I['SortCardType']>=0x0&&I['PName']['sort']((Z,J)=>{var d,y;return((d=H[Z['prototype']['EName']])!==null&&d!==void 0x0?d:F[Z['prototype']['EName']])-((y=H[J['prototype']['EName']])!==null&&y!==void 0x0?y:F[J['prototype']['EName']]);});let W=/Forest|Marsh|Polar|Industry|Mirage/['test'](oS['Lvl'])&&!/jx|Bonus_level/['test'](oS['Lvl']);I['CanSelectCard']=I['PName']['length']>(oS['Slots']||(W?JSON['parse'](localStorage['JNG_TR_Slots']||0x7):0xa));}oAudioManager['Init'](),oP['FlagToMonitor']=(c===null||c===void 0x0?void 0x0:c['FlagToMonitor'])||new Object(),oP['FlagToEnd']=(c===null||c===void 0x0?void 0x0:c['FlagToEnd'])||I['DefaultFlagToEnd'],oS['LoadingPName']['push'](...oS['PName']),oCoord[I['Coord']](),oP['Init'](c),oT['Init'](I['R']),oZ['Init'](I['R']),oGd['Init'](),oBu['Init'](),oCoinContent['Init'](),oTombstone['Init'](),I['LoadProgress'](),oZombieLayerManager['init']();},'LoadProgress'(){oS['LoadingStage']='LoadingRes';let g=oS['PicArr'],i=oS['DynamicPicArr'],c=oS['AudioArr'];for(let X of oS['LoadingPName']){let F=X['prototype'];F['PicArr']['forEach'](H=>{oDynamicPic['checkOriginalURL'](H)?i['push'](H):g['push'](oURL['removeParam'](H,'useDynamicPic'));}),c=c['concat'](F['AudioArr']);}const w=GetX(0xb),I=oGd['$ZF'],Q=oS['R']+0x1,k=Array['from'](oS['ZName']);for(let H of k){let W=H['prototype'];W['PicArr']['forEach'](x=>{oDynamicPic['checkOriginalURL'](x)?i['push'](x):g['push'](oURL['removeParam'](x,'useDynamicPic'));}),W['Init'](w,W,I,Q);if(!isNullish(W['SubsidiaryZombies']))k['push'](...W['SubsidiaryZombies']);}oS['PicArr']=g['unique']()['filter'](x=>x&&!/^data:image\/\w+;base64/['test'](x)),oS['DynamicPicArr']=i['unique'](),oS['MustLoadNum']=oS['PicArr']['length']+oS['DynamicPicArr']['length']+oS['MusicArr']['length']+oS['VideoArr']['length'],oS['ResolveLoadNum']=0x0,oS['RejectLoadNum']=0x0;const f=oLoadRes['loadImage']({'resourceArr':oS['PicArr'],'singleResolveCB':x=>oS['ResolveLoadNum']++,'singleRejectCB':x=>oS['RejectLoadNum']++}),G=oDynamicPic['Init']({'singleResolveCB':x=>oS['ResolveLoadNum']++,'singleRejectCB':x=>oS['RejectLoadNum']++}),z=oLoadRes['loadAudio']({'resourceArr':oS['MusicArr'],'type':'music','singleResolveCB':x=>oS['ResolveLoadNum']++,'singleRejectCB':x=>oS['RejectLoadNum']++}),e=oLoadRes['loadVideo']({'resourceArr':oS['VideoArr'],'timeout':0x7a120});Promise['allSettled']([f,G,z,e])['then'](x=>oS['LoadReady'](oS)),oLoadRes['loadAudio']({'resourceArr':c});},'LoadReady'(g){var i;if(oS['LoadingStage']!=='LoadingRes')return;SetNone($('loading')),oS['LoadingStage']='Finished',oSym['NowStep']=$User['NowStep'],oSym['TimeStep']=$User['TimeStep'],$('sFlagMeterTitleF')['innerHTML']=g['LevelName'],SetHidden($('dFlagMeterContent'),$('dFlagMeter')),SetVisible($('tGround')),!isNullish(g['backgroundImage'])&&($('tGround_Image')['style']['background']='url('+g['backgroundImage']+')\x20no-repeat'),g['backgroundMask']&&FightingScene['classList']['add'](g['backgroundMask']),(oS===null||oS===void 0x0?void 0x0:(i=oS['changeDKindConfig'])===null||i===void 0x0?void 0x0:i['background_sky'])&&($('tGround_Sky')['style']['background']='url:('+oS['changeDKindConfig']['background_sky']+')'),DisplayZombie(...g['SummonZombieArea']);const c=function(w){NewEle('imgGrowSoil','img','visibility:hidden;z-index:50',null,FightingScene),NewEle('dTitle','div',0x0,0x0,EDAll);if($User['enabledMoreStartingSun']&&$('dSunNum')['style']['visibility']!='hidden')oS['SunNum']+=0x64;innerText(ESSunNum,g['SunNum']),oSelectCardGUI['Init'](),oS['isScroll']?oSym['addTask'](!w?0x5a:w,oS['ScrollScreen']):oS['NoScroll']();};g['LoadAccess']?g['LoadAccess'](c):c();},'NoScroll'(){SetVisible($('dMenu')),oSelectCardGUI['selectSeveralCards'](oS['PName']);const g=$('dCardList');EDAll['scrollLeft']=oS['EDAllScrollLeft'],g['style']['left']=oS['EDAllScrollLeft']+'px',oSym['addTask'](0x1e,LetsGO);},'ScrollScreen'(g=0x0,i=oS['GroundPictureWidth']-oS['W']){let c=0x82;const w=$('dCardList');if(g<c){EDAll['scrollLeft']=Math['round'](Math['Lerp'](0x0,i,(Math['sin'](g/c*Math['PI']-Math['PI']/0x2)+0x1)/0x2));let I=new Date();requestAnimationFrame(()=>{oS['ScrollScreen'](g+(new Date()-I)/0xa*oSym['NowSpeed'],i),w['style']['left']=EDAll['scrollLeft']+'px';});}else EDAll['scrollLeft']=i,w['style']['left']=i+'px',SetVisible($('dMenu')),oS['CanSelectCard']?requestIdleCallback(()=>{oSelectCardGUI['show'](Q=>{$User['_tmpARCARD'][oS['Lvl']]&&oSelectCardGUI['selectSeveralCards']($User['_tmpARCARD'][oS['Lvl']]);});if(!oPropSelectGUI['rerender'])oPropSelectGUI['Init']();oPropSelectGUI['show'](),oPropSelectGUI['rerender']=0x0;}):(oSelectCardGUI['selectSeveralCards'](oS['PName']),oSym['addTask'](0xc8,oS['ScrollBack'],[LetsGO]));},'ScrollBack'(g){const i=$('dCardList'),c=$('viewDOM');let w=EDAll['scrollLeft'],I=Math['round'](Math['abs'](oS['EDAllScrollLeft']-w)/0x1f4*0x82),Q=0x0,k=$User['LowPerformanceMode']?0x4:0x2;oS['CanSelectCard']&&(c['style']['left']=-EDAll['scrollLeft']+'px',c['style']['visibility']='hidden'),function f(){if(Q<I&&w!=oS['EDAllScrollLeft']){let G=Math['floor'](Math['Lerp'](w,oS['EDAllScrollLeft'],(Math['sin'](Q/I*Math['PI']-Math['PI']/0x2)+0x1)/0x2));EDAll['scrollLeft']=G,i['style']['left']=G+'px',oSym['Timer']?z():oSym['addTask'](0x0,z);function z(){let e=new Date();requestAnimationFrame(()=>{Q+=(new Date()-e)/0xa*oSym['NowSpeed'],f(g);});}}else EDAll['scrollLeft']=oS['EDAllScrollLeft'],i['style']['left']=oS['EDAllScrollLeft']+'px',oSym['addTask'](0x0,g);}();}},oCoord={['1'](){oS['R']=0x5,window['ChosePlantX']=g=>{let i=GetC(g-oS['FightingSceneLeft']+oS['EDAllScrollLeft']);return[GetX(i),i];},window['ChosePlantY']=g=>{let i=GetR(g);return[GetY(i),i];};{let g=$SSmlList([-0x32,0x64,0x8c,0xe1,0x131,0x181,0x1d1,0x221,0x271,0x2c1,0x311,0x361,0x3a7,0x407],[-0x2,-0x1,0x0,0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc]);window['GetC']=i=>$SEqlSml(Math['floor'](i)-g[0x1],g[0x0],g[0x2]);};window['GetR']=i=>$SSml(i,[0x56,0xae,0x10e,0x17c,0x1d6],[0x0,0x1,0x2,0x3,0x4,0x5]),window['GetX']=i=>$SEql(i,{'-2':-0x32,'-1':0x64,0x0:0x8c,0x1:0xbb,0x2:0x10b,0x3:0x15b,0x4:0x1ab,0x5:0x1fb,0x6:0x24b,0x7:0x29b,0x8:0x2eb,0x9:0x33b,0xa:0x361,0xb:0x3b6,0xc:0x41a}),window['GetY']=i=>[0x4b,0xaf,0x10e,0x17c,0x1d6,0x23f][i],window['GetY1Y2']=i=>$SEql(i,{0x0:[0x0,0x4b],0x1:[0x4c,0xaf],0x2:[0xb0,0x10e],0x3:[0x10f,0x17c],0x4:[0x17d,0x1d6],0x5:[0x1d7,0x23f]}),window['GetMidY']=i=>{let[c,w]=window['GetY1Y2'](i);return Math['round']((c+w)/0x2);};{let i=$SSmlList([-0x32,0x64,0x8c,0xc5,0x115,0x165,0x1b5,0x205,0x255,0x2a5,0x2f5,0x345,0x3a7,0x407],[-0x2,-0x1,0x0,0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc]);window['GetMidC']=c=>$SEqlSml(Math['floor'](c)-i[0x1],i[0x0],i[0x2]);};window['GetMidR']=c=>$SSml(c,[0x56,0xa2,0x100,0x16a,0x1c4,0x230],[0x0,0x1,0x2,0x3,0x4,0x5,0x6])-0x1,!oS['InitLawnMover']&&(oS['InitLawnMover']=c=>{for(let w=0x1;w<0x6;w++)oSym['addTask'](w*0xa,CustomSpecial,[oLawnCleaner,w,-0x1]);}),oS['HaveFog']&&oFog['init']()['firstRender'](),oZombieLayerManager['initContainer']();},['2'](){oS['R']=0x6;let g=(i,w,I,Q,k)=>(k=i<w?w:i>I?I:i,Q?[Q(k),k]:[k]);window['ChosePlantX']=i=>g(GetC(i),0x1,oS['C'],GetX),window['ChosePlantY']=i=>$SSml(i,[0x56,0xab,0x108,0x170,0x1b8,0x214],[[0x4b,0x0],[0xa1,0x1],[0xfe,0x2],[0x166,0x3],[0x1ae,0x4],[0x20c,0x5],[0x251,0x6]]);{let i=$SSmlList([-0x32,0x64,0x8c,0xdc,0x127,0x17b,0x1cc,0x21c,0x271,0x2b7,0x307,0x357,0x3a7,0x407],[-0x2,-0x1,0x0,0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc]);window['GetC']=c=>$SEqlSml(Math['floor'](c)-i[0x1],i[0x0],i[0x2]);};window['GetR']=c=>$SSml(c,[0x56,0xab,0x108,0x170,0x1b8,0x214],[0x0,0x1,0x2,0x3,0x4,0x5,0x6]),window['GetX']=c=>$SEql(c,{'-2':-0x32,'-1':0x64,0x0:0x8c,0x1:0xbb,0x2:0x10b,0x3:0x15b,0x4:0x1ab,0x5:0x1fb,0x6:0x24b,0x7:0x29b,0x8:0x2eb,0x9:0x33b,0xa:0x361,0xb:0x3b6,0xc:0x41a}),window['GetY']=c=>[0x4b,0xa5,0xfd,0x163,0x1ae,0x20a,0x24b][c],window['GetY1Y2']=c=>$SEql(c,{0x0:[0x0,0x55],0x1:[0x56,0xaa],0x2:[0xab,0x107],0x3:[0x108,0x16f],0x4:[0x170,0x1b7],0x5:[0x1b8,0x213],0x6:[0x214,0x258]}),!oS['InitLawnMover']&&(oS['InitLawnMover']=()=>{for(let c=0x1;c<0x7;c++)oSym['addTask'](c*0xa,CustomSpecial,[c>0x2&&c<0x5&&window['oPoolCleaner']?oPoolCleaner:oLawnCleaner,c,-0x1]);}),oS['HaveFog']&&oFog['init']()['render']();}},oP={'MonitorZombiePosition'(g){g['ZX']&&g['R']&&(oP['LastDeathPosition']={'x':g['ZX']+oS['EDAllScrollLeft'],'y':GetY(g['R'])});},'Init'(g){oP['LastDeathPosition']={'x':0x217,'y':0xc8},oP['DefaultFlagTime']=0x7c6,oP['SpecialJudgment']={},oP['currentWaveNumLevels']=oP['NumLevels']=oP['NumZombies']=oP['FlagZombies']=0x0,oP['arrZombiesSummonedInOneFlag']=[];{let c=[],w=0x0;oP['randomGetLine']=(I,Q=0x1)=>{if(Math['random']()<0.15)return I['random']();if(oP['arrZombiesSummonedInOneFlag'][oS['R']+0x2]!=oP['FlagZombies']){oP['arrZombiesSummonedInOneFlag']=[],oP['arrZombiesSummonedInOneFlag'][oS['R']+0x2]=oP['FlagZombies'];for(let G=0x0;G<=oS['R']+0x1;G++){oP['arrZombiesSummonedInOneFlag'][G]=0x0;}}let k=Infinity;for(let z=I['length']-0x1;z>=0x0;z--){if(oP['arrZombiesSummonedInOneFlag'][I[z]]<k)w=0x1,c[0x0]=I[z],k=oP['arrZombiesSummonedInOneFlag'][I[z]];else oP['arrZombiesSummonedInOneFlag'][I[z]]==k&&(c[w++]=I[z]);}let f=Math['floor'](Math['random']()*w);return oP['arrZombiesSummonedInOneFlag'][c[f]]+=Q/0x2+0x1,c[f];};};if(g){Object['assign'](oP,g),oP['SpecialJudgment']={'delays':{},'checks':{}},Object['assign'](oP['SpecialJudgment'],g['SpecialJudgment']);let I=oP['FlagToEnd'];oP['FlagToEnd']=Q=>{var k;let f=oS['Lvl'];I['call'](oP);oS['DynamicDifficulty']&&oP['operateDynamicDifficulty'](0x1);let G=JSON['parse']((k=localStorage['JNG_TR_WON'])!==null&&k!==void 0x0?k:'{}');G[f]=0x1,localStorage['JNG_TR_WON']=JSON['stringify'](G),DataManager['CheckAchievement']('lvl',G);};oS['DynamicDifficulty']&&$User['OpenDynamicDifficulty']&&oP['createDynamicDifficultyArr'](oP['FlagToSumNum']['a1'],oP['FlagToSumNum']['a2']);if(oP['AZ']){let Q=oP['AZ']['sort']((F,H)=>F[0x2]-H[0x2]),k=Q['length'],f=[],G={},z={},e={},X={};oP['ArZ']=[];while(k--){let F=Q[k],H=F[0x0],W=F[0x1],x=F[0x2],r=F[0x3];if(typeof W!=='number')for(let t in W){!e[t]&&(e[t]=[]),e[t]['push']([H['prototype']['EName'],W[t]]),(t<=0x1||!z[H['prototype']['EName']])&&(z[H['prototype']['EName']]=W[t]);}else z[H['prototype']['EName']]=W;X[H['prototype']['EName']]=H,f['push']([H,x]),r&&r['forEach'](U=>G[U]?G[U]['push'](H):G[U]=[H]);}oP['AZ']=f,oP['MustShowAtFlag']=G,oP['ZombieCurrentWeight']=z,oP['ZombieWeightNeededToChange']=e,oP['ZombiesENameToZombieObj']=X;}}},'MonPrgs'(g){var i;--oP['NumZombies'],oP['NumLevels']-=(i=g===null||g===void 0x0?void 0x0:g['Lvl'])!==null&&i!==void 0x0?i:0x0;if(oP['NumZombies']<=0x0||oP['FlagZombies']<oP['FlagNum']&&oP['NumLevels']<=oS['SpawnLevelLimit']*oP['currentWaveNumLevels']||oP['SpecialJudgment']['checks'][oP['FlagZombies']]&&oP['NumZombies']<=oP['SpecialJudgment']['checks'][oP['FlagZombies']]){if(oP['currentWaveNumLevels']===-0x1)return;oP['currentWaveNumLevels']=-0x1;let c=oP['FlagZombies'];c<oP['FlagNum']?(oP['ReadyFlag']=++c,oSym['addTask'](oP['NumZombies']<=0x0?0x64:0xc8,oP['FlagPrgs'])):oP['CheckWin']();}},'AddZombiesFlag'(){oAudioManager['playAudio']('awooga'),oS['ControlFlagmeter']&&SetVisible($('dFlagMeterContent')),oP['ReadyFlag']=0x1,oP['FlagPrgs']();},'FlagPrgs'(){let g=oP['FlagZombies'],i=oP['FlagToSumNum'],c=$SSml(g,i['a1'],i['a2']);if(oP['FlagNum']>(g=++oP['FlagZombies'])){let I=$SEql(g,oP['FlagToMonitor']);if(I){var w;let Q=(w=I[0x2])!==null&&w!==void 0x0?w:Math['max'](0x0,oP['DefaultFlagTime']-0x12c);oSym['addTask'](Q,k=>{if(I['__jng_called__']!==!![]){const f=I[0x1];!!f&&f[Symbol['iterator']]?I[0x0](...I[0x1]):I[0x0](),Object['defineProperty'](I,'__jng_called__',{'value':!![],'configurable':![],'enumerable':![]});}});}oSym['addTask'](oP['DefaultFlagTime'],k=>{oP['ReadyFlag']===g&&(oP['ReadyFlag']++,oP['FlagPrgs']());});}if(oP['ZombieWeightNeededToChange'][g])for(let k of oP['ZombieWeightNeededToChange'][g]){oP['ZombieCurrentWeight'][k[0x0]]=k[0x1];}oS['ControlFlagmeter']&&oFlagContent['__HeadEle__']['className']=='NormalHead'&&oFlagContent['update']({'curValue':g-0x1}),oP['SelectFlagZombie'](c,g),function f(G=0x0){if(oP['FlagZombies']>=oP['FlagNum']&&oP['FlagZombies']>0x0){let z=0x0;for(let e of $Z){if(e['isCounted'])z++;}if(z==0x0){if(G<0x5)oSym['addTask'](0xc8,()=>{f(++G);});else{console['warn']('[PVZTR]\x20CheckWin\x20Error!\x20oP.NumZombies:\x20'+oP['NumZombies']),toWin();for(let X of $Z){if(!X['isPuppet'])X['ExplosionDie']();}}}else oSym['addTask'](0x1f4,()=>{f(0x0);});}}();},'CheckWin'(){let g=oP['FlagToSumNum'],i=$SSml(oP['FlagNum'],g['a1'],g['a2']),c=i<0x1?Math['max'](0x1f4,oP['DefaultFlagTime']-0x5d2):0x1f4;oSym['addTask'](c,()=>{if(oP['NumZombies']<=0x0){let w=0x0;for(let I of $Z){!I['isPuppet']&&(w++,I['NormalDie']());}oSym['addTask'](w?0x12c:0x0,()=>{toWin();});}});},'SelectFlagZombie'(g,c){let w=oP,I=w['ArZ'],Q=w['AZ'],k=[],f=0x0,G=[],z=w['SpecialJudgment']['delays'][c]||0x96,e=![],X=Q['length'],F=g;while(X--){let U=Q[X];if(U[0x1]>c)break;else Q['pop'](),I['push'](U[0x0]),e=!![];}e&&I['sort']((u,O)=>u['prototype']['Lvl']-O['prototype']['Lvl']);for(let u of I){k[f++]=oP['ZombieCurrentWeight'][u['prototype']['EName']],f>0x1&&(k[f-0x1]+=k[f-0x2]);}function H(O,D,V,Z){let J;while(D<=V){J=Math['floor']((D+V)/0x2),Z>O[J]?D=J+0x1:V=J-0x1;}return D;}let W=w['MustShowAtFlag'][c];if(W)for(let O of W){G['push'](O),g-=O['prototype']['Lvl'];}let x=I['length'];if(x<0x1)return;let r=x-0x1,t=I[r]['prototype']['Lvl'];while(g>0x0){if(r&&t>g){while(--r&&I[r]['prototype']['Lvl']>g);x=r+0x1,t=I[r]['prototype']['Lvl'];}let D=I[H(k,0x0,x,Math['random']()*k[x-0x1])];g-=D['prototype']['Lvl'],G['push'](D);}w['NumZombies']+=G['length'],w['NumLevels']+=F-g,w['currentWaveNumLevels']=F-g,w['SetTimeoutZombie'](G,z);},'SetTimeoutZombie'(g,i){let c=0x0;g['forEach'](w=>{const I=new w(),Q=I['prepareBirth'](c),k=$n('template');k['innerHTML']=Q;const f=()=>{oZombieLayerManager['$Containers'][I['R']]['append'](k['content']),I['Birth']();};requestIdleCallback(()=>{oSym['Timer']?f():oSym['addTask'](0x0,f);}),c+=i*(Math['random']()*0.2+0.9);});},'AppearUP'(g,i,c,w,I){let{useEleBodyAnim:Q,useDirtAnim:k}=w;const f=oGd['$GdType'][i][c]===0x2,G=g['CustomBirth'](i,c,Q?0x1f:0x0,0x0);if(!G)return;const z=()=>{const F=oZombieLayerManager['$Containers'][i],H=g['zIndex_cont']+0x2;if(f&&!g['Ethereal'])oAudioManager['playAudio']('Rifter_Summon'+(0x1+Math['floor'](Math['random']())),![],0.3),oEffects['ImgSpriter']({'ele':NewEle('Dirt_'+Math['random'](),'div','position:absolute;overflow:hidden;z-index:'+H+';width:150px;height:184px;left:'+(0x302-(0x9-c)*0x52)+'px;top:'+(0x64*(i-0x1)+0xb)+'px;transform:scale(1.4);background:url(images/Props/Rifter/Drop_Water.png)\x20no-repeat',0x0,F),'styleProperty':'X','changeValue':-0x96,'frameNum':0x25,'interval':0x4,'callback':ClearChild});else!g['Ethereal']&&(oAudioManager['playAudio']('dirt_rise'),oEffects['ImgSpriter']({'ele':NewEle('Dirt_'+Math['random'](),'div','position:absolute;background:url(images/Zombies/dirt.png)\x20no-repeat;z-index:'+H+';left:'+(0x2fe-(0x9-c)*0x50)+'px;top:'+(0x64*(i-0x1)+0x19)+'px;height:162px;width:126px;',0x0,F),'styleProperty':'X','changeValue':-0x7e,'frameNum':0x16,'callback':W=>oEffects['fadeOut'](W,'slow',ClearChild)}));},e=$n('template');e['innerHTML']=G;const X=()=>{g['useTraditionalWrap']?EDPZ['append'](e['content']):oZombieLayerManager['$Containers'][g['R']]['append'](e['content']),g['Birth'](void 0x0,!![]);if(!g['Ele'])return;SetBlock(g['Ele']);let F=g['height'],H=g['EleBody'],W=f?oGd['$WaterDepth'][i][c]+g['extraDivingDepth']:0x0;if(g['Ethereal'])H['style']['opacity']='0.5';f&&g['setWaterStyle_middleWare']();if(Q){let x=g['Altitude'];g['Altitude']=0x3,H['style']['top']=F+'px',oEffects['Animate'](H,{'top':W+g['GetDTop']+'px','clip':'rect(0px,\x20auto,\x20'+(F-W)+'px,\x200px)'},Math['abs'](F-W)/0x8c*0.3/oSym['NowSpeed'],'ease-out',()=>{!f&&SetStyle(H,{'clip':'rect(0,auto,auto,0)'});}),oSym['addTask'](0x1e,()=>{g['Altitude']=x,f&&(g['useSinkIntoWaterEffect'](g,W),g['SetWater'](W,i,c,null,![],![]));});}else f?(g['useSinkIntoWaterEffect'](g,W),g['SetWater'](W,i,c,null,![],![])):SetStyle(H,{'top':W+g['GetDTop']+'px','clip':'rect(0,auto,auto,0)'});if(k)z();};return g['isCounted']&&(oP['NumZombies']++,oP['NumLevels']+=g['Lvl']),I?X():requestIdleCallback(()=>{oSym['Timer']?X():oSym['addTask'](0x0,X);},{'timeout':0x3e8}),g;},'Monitor'(g){g&&g['f'](...g['ar']);const i=oZ['traversalOf'],c=oZombieLayerManager['refresh']['bind'](oZombieLayerManager),w=oBu['traversalOf']['bind'](oBu);if($User['TaskForceTimeSync']){let I=Date['now'](),Q=I,k=I,f=null,G=$User['LowPerformanceMode']?0x11:oSym['BuMonitorRefresh'],z;requestAnimationFrame(function e(){k=Date['now'](),f&&(I+=k-f,Q+=k-f,f=null),(z=oSym['CalcTimePassed'](k-Q)*oSym['NowSpeed'])>=G&&(w(z/oSym['BuMonitorRefresh']),Q=k),(z=oSym['CalcTimePassed'](k-I)*oSym['NowSpeed'])>=oSym['ZMonitorRefresh']&&(i(z/oSym['ZMonitorRefresh']),I=k,oS['observeZombieLayer']&&c()),oSym['Timer']?requestAnimationFrame(e):((()=>{f=k,oSym['addTask'](0x1,e);})());});}else{let X=oSym['ZMonitorRefresh']/0xa,F=oSym['BuMonitorRefresh']/0xa;(function H(){i(),oS['observeZombieLayer']&&c(),oSym['addTask'](X,H);}(),$User['LowPerformanceMode']?function W(){w(0x3),oSym['addTask'](0x3,W);}():function x(){w(),oSym['addTask'](F,x);}());}if($User['DrawBlood']){let r=$User['LowPerformanceMode']?0x4/0x5:0x1,t=NewEle('','canvas','position:absolute;left:0;top:0;width:'+oS['W']+'px;height:600px;pointer-events:none;z-index:'+0x3*(oS['R']+0x1),{'width':Math['floor'](oS['W']*r),'height':Math['floor'](0x258*r)},EDPZ),U=t['getContext']('2d');U['globalAlpha']=0.7;let u={'width':0x32,'height':0x3},O=-0x3;function D(Z,J,d,L){U['fillRect'](Math['round'](Z*r),Math['round'](J*r),Math['round'](d*r),Math['round'](L*r));}const V=()=>{U['clearRect'](0x0,0x0,Math['floor'](oS['W']*r),Math['floor'](0x258*r));let Z=[],J=[],d=[],y=[],L=[],R;U['fillStyle']='#555555';for(let h of $Z){if(h['CanDrawBlood']){var l;let Y={'x':h['X']+(h['beAttackedPointL']+h['beAttackedPointR'])/0x2,'y':h['pixelTop']+((l=h['HeadTargetPosition'][h['isAttacking']])!==null&&l!==void 0x0?l:h['HeadTargetPosition'][0x0])['y']-0xa-u['height'],'HPRatio':Math['max'](0x1,Math['min'](0x3,((h['constructor']['prototype']['HP']-h['BreakPoint'])/0x1f4)**0x1/0x3))};Y['x']-=u['width']*Y['HPRatio']/0x2;let N=![];if(h['ShieldHP']>0x0&&h['ShieldHP']<(R=h['OShieldHP'])){let S=Object['assign']({'ratio':h['ShieldHP']/R},Y);S['HPRatio']=Math['max'](0x1,Math['min'](0x3,((h['constructor']['prototype']['HP']-h['BreakPoint'])/0x1f4)**0x1/0x3)),S['y']-=0x6,Z['push'](S),D(S['x']-0x2,S['y']-0x2,u['width']*S['HPRatio']+0x4,u['height']+0x4);}if(h['OrnHP']>0x0&&h['OrnHP']<(R=h['constructor']['prototype']['OrnHP'])&&h['OrnHP']<Infinity){let a=Object['assign']({'ratio':h['OrnHP']/R},Y);a['HPRatio']=Math['max'](0x1,Math['min'](0x3,(R/0x1f4)**0x1/0x3)),a['y']+=O,L['push'](a),D(a['x']-0x2,a['y']-0x2,u['width']*a['HPRatio']+0x4,u['height']+0x4),N=!![];}if((h['HP']!=(R=h['constructor']['prototype']['HP'])&&h['HP']<Infinity||N)&&h['HP']>=h['BreakPoint']){let C=h['constructor']['prototype']['HP']>0x1194||h['EName']=='oMembraneZombieSP'?J:d;C['push'](Object['assign']({'ratio':Math['min'](0x1,(h['HP']-h['BreakPoint'])/(R-h['BreakPoint']))},Y));if(h['HP']>R){let P=Math['min'](0x1,(h['HP']-R)/0x12c);for(let v=0x1;v<=(P>=0x1?0x2:0x1);v++){y['push'](Object['assign']({'ratio':P},Y));}}D(Y['x']-0x2,Y['y']-0x2,u['width']*Y['HPRatio']+0x4,u['height']+0x4);}}}for(let M of $P){let p={'x':M['pixelLeft']+M['width']/0x2,'y':GetY(M['R'])-u['height']-0x5f+M['BloodBarRelativeHeight'],'HPRatio':Math['max'](0x1,(((R=M['tempHP']||M['constructor']['prototype']['HP'])-M['BlueBarHP'])/0x3e8)**0x1/0x4)};p['x']-=u['width']*p['HPRatio']/0x2;let n=M['BlueBarHP']-(R-M['HP']);if(M['HP']<R&&n>0x0){let s=Object['assign']({'ratio':n/M['BlueBarHP']},p);s['HPRatio']=Math['max'](0x1,(M['BlueBarHP']/0x5dc)**0x1/0x4);let K=0x0;R>M['BlueBarHP']&&(K=O),s['y']+=K,L['push'](s),D(p['x']-0x2,p['y']-0x2+K,u['width']*s['HPRatio']+0x4,u['height']+0x4);}if(R>M['BlueBarHP']&&M['HP']!=R&&M['HP']>0x0&&M['HP']<Infinity){p['ratio']=Math['min'](M['HP']/(R-M['BlueBarHP']),0x1),p['HPRatio']=Math['max'](0x1,((R-M['BlueBarHP'])/0x3e8)**0x1/0x4),d['push'](p);if(M['HP']>R){let b=Object['assign']({},p);b['ratio']=Math['min'](0x1,(M['HP']-R)/0x3e8);for(let E=0x1;E<=(b['ratio']>=0x1?0x2:0x1);E++){y['push'](b);}}D(p['x']-0x2,p['y']-0x2,u['width']*p['HPRatio']+0x4,u['height']+0x4);}}U['fillStyle']='#D210EE';for(let A=Z['length']-0x1;A>=0x0;A--){D(Z[A]['x'],Z[A]['y'],u['width']*Z[A]['ratio']*Z[A]['HPRatio'],u['height']);}U['fillStyle']='#ff6b6b';for(let m=J['length']-0x1;m>=0x0;m--){D(J[m]['x'],J[m]['y'],u['width']*J[m]['ratio']*J[m]['HPRatio'],u['height']);}U['fillStyle']='#55FF55';for(let B=d['length']-0x1;B>=0x0;B--){D(d[B]['x'],d[B]['y'],u['width']*d[B]['ratio']*d[B]['HPRatio'],u['height']);}U['fillStyle']='#ffffff';for(let T=y['length']-0x1;T>=0x0;T--){D(y[T]['x'],y[T]['y'],u['width']*y[T]['ratio']*y[T]['HPRatio'],u['height']);}U['fillStyle']='#00CCFF';for(let q=L['length']-0x1;q>=0x0;q--){D(L[q]['x'],L[q]['y'],u['width']*L[q]['ratio']*L[q]['HPRatio'],u['height']);}return Math['floor'](($User['LowPerformanceMode']?1.2:0x1)*oSym['NowSpeed']*Math['Clamp']((d['length']+L['length']+Z['length']+y['length'])*0x2/0x3,0x14,0x96));};(function Z(){oSym['addTask'](V(),Z,void 0x0,!![]);}());}},'operateDynamicDifficulty'(g=null,i=![],c=![]){let w=Number['parseInt'](localStorage['JNG_TR_DYNAMIC_DIFFICULTY_WINRATE'])||0x0;if(g===null)return Math['round'](w);if(i)w=g;else{if(c)w+=g;else{if(g<0x0&&w+g>=0xe)w=0xd;else g>0x0&&w+g<=-0x4?w=-0x2:w+=g;}}return w=Math['Clamp'](w,-0x5,0x14),localStorage['JNG_TR_DYNAMIC_DIFFICULTY_WINRATE']=w,Math['round'](w);},'createDynamicDifficultyArr'(g,c){const w=oP['operateDynamicDifficulty']();for(let I=0x0;I<c['length'];I++){if(c[I]===0x0)continue;c[I]=Math['round'](c[I]*Math['sqrt'](w*0.06+0x1));}},'Destroy'(){delete oP['AZ'],delete oP['FlagToSumNum'],delete oP['FlagToMonitor'];}},oGd={'Init'(){let g=this;g['$']={},g['$LockingGrid']={},g['__LockGridType__']=['$Sculpture','$Obstacle','$Tombstones','$Crystal','$Rifter','$IceBlock','$Crater'],g['__LockGridType__']['forEach'](c=>{g[c]={};}),g['$Torch']={},g['$TrafficLights']={},g['$Plantern']={},g['$Umbrella']={},g['$Lava']={},g['$PortalsMap']={},g['$Link']={},g['$DeadLink']={},g['$Coins']={},g['$LF']=oS['LF'],g['$ZF']=oS['ZF'],g['$GdType']=[],g['$WaterDepth']=[],g['$JackinTheBox']=0x0,g['$WaterFlowDirection']=[],g['$Portals']=[],oIceRoad['init']();for(let c=0x0;c<=oS['R']+0x1;c++){g['$GdType'][c]=[],g['$WaterDepth'][c]=[],g['$WaterFlowDirection'][c]=[];for(let w=0x0;w<=oS['C']+0x1;w++){g['$GdType'][c][w]=0x1<=w&&w<=0x9?g['$LF'][c]:0x0;}}oS['InitWaterPath']&&oWaterPath['init']();},'isValidCrood'(g){return/\d+_\d+/['test'](g);},'add'(g,i){let c=this['$'],w=c[i];w&&w['Die']&&w['Die'](),c[i]=g;},'del'(g){delete this['$'][g['R']+'_'+g['C']+'_'+g['PKind']];},'killAll'(g,c,w='JNG_TICKET_ShovelPlant'){const I=this['$'];for(let Q=0x0;Q<=PKindUpperLimit;Q++){let k=g+'_'+c+'_'+Q;I[k]&&I[k]['Die'](w);}},'isLocked'(g,i){const c=oGd['isValidCrood'](g)?g:g+'_'+i;return this['__LockGridType__']['some'](w=>!isNullish(this[w][c]));},'unlockGrid'(g,i){const c=oGd['isValidCrood'](g)?g:g+'_'+i;if(this['isLocked'](c)||!oGd['isValidCrood'](c))return![];return delete this['$LockingGrid'][c];}};class __BulletPool__{constructor(){this['pool']=[];}['get'](){var g;return(g=this['pool']['pop']())!==null&&g!==void 0x0?g:{};}['recycle'](g){Object['keys'](g)['forEach'](i=>{delete g[i];}),this['pool']['push'](g);}};const oBu={'Init'(){var g;let i=this;i['$Bullets']={},i['__pool__']=(g=i['__pool__'])!==null&&g!==void 0x0?g:new __BulletPool__();},'createBullet'(g,...i){const c=this['__pool__']['get']();return c['__proto__']=g['prototype'],g['call'](c),c['Birth'](...i);},'del'(g){let i=this,c=g['id'],w=i['$Bullets'];!isNullish(w[c])?(delete w[c],i['__pool__']['recycle'](g)):console['warn']('[PVZTR]\x20Can\x27t\x20destroy\x20a\x20missing\x20bullet\x20'+c+'.');},'add'(g,i){let c=this;c['$Bullets'][i]=g;},'traversalOf'(g=0x1){let i=this,c=i['$Bullets'];for(let w of c){w['Update'](w,g);}}};var oZ={'Init':function(g){this['$']=[],this['$R']=[];for(let c=g;c;this['$'][c]=[],this['$'][c]['__tmpLen__']=0x0,this['$R'][c--]=[]);},'add'(g){let i=oZ['$'][g['R']];i['__tmpLen__']++,i['push'](g),i['sort']((c,w)=>c['AttackedLX']-w['AttackedLX']),i['RefreshTime']=oSym['Now'];},'del'(g,i){const c=typeof g==='number'?oZ['$'][g]:g;c['__tmpLen__']--,c['splice'](i,0x1);},'getZ0'(g,c,w=z=>!![]){if(c<0x1||c>oS['R'])return;let I=0x0,Q=this['$'][c],k,f=Q['__tmpLen__'];while(I<f&&((G=k=Q[I++])===null||G===void 0x0?void 0x0:G['AttackedLX'])<=g){var G;if(k['HP']&&k['AttackedRX']>=g&&w(k))return k;}},'getZ0Spd'(g,c,w=X=>!![],I=0x0){if(c<0x1||c>oS['R'])return;let Q=0x0,k=this['$'][c],f,G=k['__tmpLen__'],z=I;while(Q<G&&((e=f=k[Q++])===null||e===void 0x0?void 0x0:e['AttackedLX'])<=g['pixelLeft']+g['Width']+g['Speed']*z){var e;if(f['HP']&&One_Dimensional_Intersection(f['AttackedLX'],f['AttackedRX'],g['pixelLeft'],g['pixelLeft']+g['Width']+g['Speed']*z)&&w(f))return f;}},'getZ1':function(g,c,w=F=>!![]){if(c<0x1||c>oS['R'])return;let I=0x0,Q=this['$'][c],k=this['$R'][c],f,G,z,e;(z=Q['RefreshTime'])===k['RefreshTime']?f=k:(f=this['$R'][c]=Q['slice'](0x0),f['sort'](function(F,H){return H['AttackedRX']-F['AttackedRX'];}),f['RefreshTime']=z);e=Q['__tmpLen__'];while(I<e&&((X=G=f[I++])===null||X===void 0x0?void 0x0:X['AttackedRX'])>=g){var X;if(G['HP']&&G['AttackedLX']<=g&&w(G))return G;}},'getZ1Spd'(g,c,w=W=>!![],I=0x0){if(c<0x1||c>oS['R'])return;let Q=0x0,k=this['$'][c],f=this['$R'][c],G,z,e,X,F=I;(e=k['RefreshTime'])===f['RefreshTime']?G=f:(G=this['$R'][c]=k['slice'](0x0),G['sort'](function(W,x){return x['AttackedRX']-W['AttackedRX'];}),G['RefreshTime']=e);X=k['__tmpLen__'];while(Q<X&&((H=z=G[Q++])===null||H===void 0x0?void 0x0:H['AttackedRX'])>=g['pixelLeft']-g['Speed']*F){var H;if(z['HP']&&One_Dimensional_Intersection(z['AttackedLX']-z['getRealSpeedJudge'](z,0x1)*F*oSym['BuMonitorRefresh']/oSym['ZMonitorRefresh'],z['AttackedRX'],g['pixelLeft']-g['Speed']*F,g['pixelLeft']+g['Width'])&&w(z))return z;}},'getArZ'(g,i,c,w=Q=>!![]){let I=[];for(let Q of this['$'][c]){const k=Q['AttackedLX'];if(k>=i)break;Q['HP']&&(Q['AttackedRX']>g||Q['AttackedLX']>g)&&w(Q)&&I['push'](Q);}return I;},'getRangeLeftZ'(g,i,c,w=![],I=![],Q){if(c<0x1||c>oS['R'])return;let k=this['$'][c],f;for(let G of k){const{AttackedLX:z,AttackedRX:e}=G;if(z>i)break;if(G['HP']&&(g<z||g<e)){if(G['Altitude']>=0x3||G['Ethereal'])continue;if(w&&G['isPuppet']){!f&&(f=G);continue;}if(I&&G['HP']<G['BreakPoint'])continue;if(Q&&!Q(G))continue;return G;}}return w?f:null;},'getRangeRightZ'(g,c,w,I=![]){if(w<0x1||w>oS['R'])return;let Q=this['$'][w],k,f=Q['__tmpLen__'];for(let G=f-0x1;G>=0x0;G--){const z=Q[G],{AttackedLX:e,AttackedRX:X}=z;if(X<g)break;if(z['HP']&&(e<c||X<c)){if(z['Altitude']>=0x3||z['Ethereal'])continue;if(I&&z['isPuppet']){!k&&(k=z);continue;}return z;}}return I?k:null;},'moveTo'(g,c,w){var I=this['$'][c],Q=this['$'][w],k=I['__tmpLen__'],f;while(k--){let G=I[k];G&&G['id']==g&&Q&&(I['__tmpLen__']--,I['splice'](k,0x1),G['R']=w,Q['__tmpLen__']++,Q['push'](G),Q['sort'](function(z,e){return z['AttackedLX']-e['AttackedLX'];})['RefreshTime']=I['RefreshTime']=oSym['Now'],k=0x0);}},'traversalOf'(g=0x1){let i=oZ['$'],c=[e=>{I=0x1;},e=>{(k=e['AttackedLX'])>Q&&(w=I=0x1),Q=k;}],w=0x0,I=0x0,Q,k,f,G,z;for(let e=0x1,X=i['length'];e<X;e++){f=i[e],G=f['__tmpLen__'],Q=Infinity;while(G--){z=f[G],IsDevEnvi&&(Number['isNaN'](z['ZX'])||Number['isNaN'](z['X'])||Number['isNaN'](z['AttackedLX'])||Number['isNaN'](z['AttackedRX']))&&console['error']('[PVZTR]\x20Find\x20a\x20zombie\x20with\x20abnormal\x20crood:',z),z['HP']?(z['ZX']<0x385&&oT['chkD'+z['WalkDirection']](z,e,oT['$'][e],oT['$L'][e],g),c[z['ChkActs'](z,e,f,G,g)](z)):(oZ['del'](f,G),c[0x0](z));}w?(w=I=0x0,f['sort']((F,H)=>F['AttackedLX']-H['AttackedLX']),f['RefreshTime']=oSym['Now']):I&&(I=0x0,f['RefreshTime']=oSym['Now']);}}},oT={'Init'(g){this['$']=[],this['$L']=[];for(let i=g;i>0x0;--i){this['$'][i]=[],this['$'][i]['tmpLength']=0x0,this['$L'][i]=[],this['$L'][i]['tmpLength']=0x0;}},'add'(g,i,c){if(g<=0x0||g>oS['R'])return;let w=this['$'][g];for(let I of i){w['push']([...I,c]);}w['sort']((Q,k)=>k[0x1]-Q[0x1]),w['tmpLength']=w['length'],w['RefreshTime']=new Date();},'chkD0'(g,c,w,I,Q){let k=g['AttackedLX'],f=0x0,G;while(f<w['tmpLength']&&(G=w[f])[0x1]>=k){let z=$P[G[0x3]];z&&z['canTrigger']&&G[0x0]<=k+g['getRealSpeedJudge'](g,Q)&&z['TriggerCheck'](g,G[0x2],f),++f;}},'chkD1'(g,c,w,I){let Q=g['AttackedRX'],k=0x0,f=w['RefreshTime'],G,z;f===I['RefreshTime']?G=I:(I=this['$L'][c]=w['slice'](0x0),G=I['sort']((e,X)=>e[0x0]-X[0x0]),G['RefreshTime']=f,G['tmpLength']=G['length']);while(k<G['tmpLength']&&(z=G[k])[0x0]<=Q){let e=$P[z[0x3]];e&&e['canTrigger']&&z[0x1]>=Q&&e['TriggerCheck'](g,z[0x2],k),++k;}},'delP'(g){let c=g['id'],w=Object['keys'](g['oTrigger']),I;for(let Q of w){I=this['$'][Q];for(let k=I['tmpLength']-0x1;k>=0x0;--k){if(I[k][0x3]===c){I['splice'](k,0x1);break;}}I['RefreshTime']=new Date(),I['tmpLength']=I['length'];}}};const oZombieLayerManager={'init'(){this['observedZombies']=new Set(),this['preRowOfZombie']=new Map();},'initContainer'(){this['$Containers']=[];const g=oS['R'];for(let c=0x1;c<=g;c++){this['$Containers'][c]=NewEle('dContainer_'+c,'div','z-index:'+0x3*c+';position:absolute;',null,EDPZ);}},'addZombie'(g){this['observedZombies']['add'](g),this['preRowOfZombie']['set'](g,g['R']);},'delZombie'(g){this['observedZombies']['delete'](g),this['preRowOfZombie']['delete'](g);},'refresh'(){const g=this['preRowOfZombie'];let i,c,w;for(let I of this['observedZombies']){if(!$Z[I['id']]){if(I['HP']<=0x0)this['delZombie'](I);continue;}i=I['R'],c=g['get'](I),c!==i&&(this['$Containers'][i]['append'](I['Ele']),g['set'](I,i)),(I['FangXiang']==='GoUp'||I['FangXiang']==='GoDown')&&((w=Math['round']((I['pixelTop']+I['height'])/0x10)*0x10)!==I['zIndex_cont']&&(I['Ele']['style']['zIndex']=I['zIndex_cont']=w));}}},oLoadRes={'loadImage'({resourceArr:g,singleResolveCB:i,singleRejectCB:c,timeout:timeout=0x12d687,resolveImgObject:resolveImgObject=![]}){let w=[];return g['forEach'](I=>{if(!I||/^data:image\/\w+;base64/['test'](I))return;let Q=new Image();Q['src']=I;let k=new Promise((f,G)=>{if(Q['complete'])f([resolveImgObject?[I,Q]:I,null]);else{let z=setTimeout(e=>G([I,'[PVZTR]\x20It\x27s\x20longer\x20than\x20the\x20limit\x20time\x20to\x20load\x20the\x20file\x20'+I]),timeout);Q['onerror']=e=>G([I,'[PVZTR]\x20Failing\x20to\x20load\x20the\x20file\x20'+I,z]),Q['onload']=e=>f([resolveImgObject?[I,Q]:I,z]);}});k['then'](([f,G])=>{G&&clearTimeout(G),i&&i(f);},([f,G,z])=>{clearTimeout(z),console['error'](G),c&&c(f,G);}),w['push'](k);}),Promise['allSettled'](w);},'loadAudio'({resourceArr:g,type:type='audio',singleResolveCB:i,singleRejectCB:c,timeout:timeout=0x12d687,canUpdateMap:canUpdateMap=![]}){let w=[];return g['forEach'](I=>{if(!I)return;let Q=new Audio();Q['src']='audio/'+I+'.mp3';let k=new Promise((f,G)=>{if(Q['readyState']===0x4)f(I);else{let z=setTimeout(e=>G([I,'[PVZTR]\x20It\x27s\x20longer\x20than\x20the\x20limit\x20time\x20to\x20load\x20the\x20file\x20'+I]),timeout);Q['onerror']=e=>G([I,'[PVZTR]\x20Failing\x20to\x20load\x20the\x20file\x20'+I,z]),Q['oncanplay']=e=>f([I,Q,z]);}})['then'](([f,G,z])=>{return clearTimeout(z),type==='audio'?(canUpdateMap||!oAudioManager['resourceAudioMap']['get'](f))&&oAudioManager['resourceAudioMap']['set'](f,{'dom':G,'num':0x0}):(canUpdateMap||!oAudioManager['resourceMusicMap']['get'](f))&&oAudioManager['resourceMusicMap']['set'](f,G),i&&i(f,G);},([f,G,z])=>{return clearTimeout(z),console['error'](G),c&&c(f,G);});w['push'](k);}),Promise['allSettled'](w);},'loadVideo'({resourceArr:g,singleResolveCB:i,singleRejectCB:c,timeout:timeout=0x75bcd15}){let w=[];return g['forEach'](I=>{if(!I)return;let Q=document['createElement']('video');Q['src']=I;let k=new Promise((f,G)=>{if(Q['readyState']===0x4)f(I);else{let z=setTimeout(e=>G([I,'[PVZTR]\x20It\x27s\x20longer\x20than\x20the\x20limit\x20time\x20to\x20load\x20the\x20file\x20'+I]),timeout);Q['onerror']=e=>G([I,'[PVZTR]\x20Failing\x20to\x20load\x20the\x20file\x20'+I,z]),Q['oncanplay']=e=>f([I,Q,z]);}});k['then'](([f,G,z])=>{clearTimeout(z),i&&i(f,G);},([f,G,z])=>{clearTimeout(z),console['error'](G),c&&c(f,G);}),w['push'](k);}),Promise['allSettled'](w);},'loadScript'({resourceArr:g,singleResolveCB:i,singleRejectCB:c,timeout:timeout=0x2710}){let w=[],I=document['getElementsByTagName']('head')[0x0];return g['forEach'](Q=>{if(!Q)return;let k=null;if(/.js$/['test'](Q)||/^blob:/['test'](Q))k=NewEle(![],'script',![],{'src':Q},I);else{if(/.css$/['test'](Q))k=NewEle(![],'link',![],{'href':Q,'rel':'stylesheet'},I);else{console['error']('[PVZTR]\x20Can\x27t\x20load\x20the\x20unknown\x20file\x20'+Q);return;}}let f=new Promise((G,z)=>{let e=setTimeout(X=>z([Q,'[PVZTR]\x20It\x27s\x20longer\x20than\x20the\x20limit\x20time\x20to\x20load\x20the\x20file\x20'+Q]),timeout);k['onerror']=X=>z([Q,'[PVZTR]\x20Failing\x20to\x20load\x20the\x20file\x20'+Q,e]),k['onload']=X=>G([Q,e]);});f['then'](([G,z])=>{clearTimeout(z),i&&i(G,k);},([G,z,e])=>{clearTimeout(e),console['error'](z),c&&c(G,z);}),w['push'](f);}),Promise['allSettled'](w);},'loadBase64Image'(g,i,c,w=0x2710){let I=document['getElementsByTagName']('head')[0x0],Q=NewEle(![],'script',![],{'src':g},I),k=new Promise((f,G)=>{let z=setTimeout(e=>G([g,'[PVZTR]\x20It\x27s\x20longer\x20than\x20the\x20limit\x20time\x20to\x20load\x20the\x20file\x20'+g]),w);Q['onerror']=e=>G([g,'[PVZTR]\x20Failing\x20to\x20load\x20the\x20file\x20'+g,z]),Q['onload']=e=>f([g,z]);});k['then'](([f,G])=>{clearTimeout(G);let z=window['__LOAD_BASE64_IMAGE_FUNCTION_TMP__'](Q);i&&((()=>{i(z);})());},([f,G,z])=>{clearTimeout(z),console['error'](G),c&&c(G);});},'loadElement'(g,i=0x7530){let c=[];return g['forEach'](w=>{let I=new Promise((Q,k)=>{if(w['complete'])Q([null]);else{let f=setTimeout(G=>k([w,'[PVZTR]\x20It\x27s\x20longer\x20than\x20the\x20limit\x20time\x20to\x20load\x20the\x20element']),i);w['onerror']=G=>k([w,'[PVZTR]\x20Failing\x20to\x20load\x20the\x20file\x20'+url,f]),w['onload']=G=>Q([f]);}});I['then'](([Q])=>{clearTimeout(Q);},([Q,k,f])=>{clearTimeout(f),console['error'](k),console['error'](Q);}),c['push'](I);}),Promise['allSettled'](c);}},oDynamicPic={'__BlobImgStorage__':new Map(),'__BlobUrlStorage__':new Map(),async'Init'({resArr:resArr=oS['DynamicPicArr'],singleResolveCB:g,singleRejectCB:i,timeout:timeout=0x7530,keepParam:keepParam=![]}){if(!IsHttpEnvi){g&&resArr['forEach'](I=>g());return;}const c=this['__BlobImgStorage__'],w=[];for(let I of resArr){!keepParam&&(I=oURL['removeParam'](I));if(c['has'](I)){g&&g();continue;}let Q=await getDataByKey(ResourcesDatabase,'images',I);if(Q)c['set'](I,Q['data']),g&&g();else{let k=null,f=fetch(I)['catch'](e=>{console['error'](e),i&&i();}),G=new Promise(e=>{k=setTimeout(e,timeout,'[PVZTR]\x20This\x20fetch\x20is\x20time-out:\x20'+I);}),z=Promise['race']([f,G])['then'](e=>{e instanceof Response?(clearTimeout(k),c['set'](I,'loading'),e['blob']()['then'](X=>{c['set'](I,X),putDataByKey(ResourcesDatabase,'images',I,X),g&&g();},X=>{console['error'](X),c['delete'](I,blob),i&&i();})):(console['error'](e),i&&i());});w['push'](z);}}await Promise['allSettled'](w);},'require'(g,i=null,c=![],w=![]){if(!$User['Async_GIFS_Animate']||g['substring'](0x0,0x5)==='blob:')return g;!w&&(g=oURL['removeParam'](g));if(!IsHttpEnvi)return oURL['setParam'](g,'ts',Math['random']());},'remove'(g,i){},'revokeGarbage'(){},'checkOriginalURL'(g){if(g&&oURL['getParam'](g,'useDynamicPic')!=='false'&&!/\/0\.(webp|gif|png)$/['test'](g)&&!/^data:image\/\w+;base64/['test'](g)&&!/\.(png|jpg)$/['test'](g)&&!g['includes']('images/Card/'))return!![];return![];}},oAudioManager={'resourceAudioMap':new Map(),'resourceMusicMap':new Map(),'playingAudioDomSet':new Set(),'forcedPausedAudio':new Set(),'forcedPausedAudioSpecific':new Set(),'pausedDeletedAudio':new Set(),'curMusic':null,'isAllResPaused':![],'isAllResMuted':![],'Init'(){this['refreshTicket'](),this['maxSyncPlayBackNum']=$User['LowPerformanceMode']?0x1:0x3;for(let[g,i]of this['resourceAudioMap']){i['num']=0x0,delete i['lastPlayingInstance'];}},'refreshTicket'(){this['__ticket__']=''+Math['random']();},'getDom'(g,i){const c=oAudioManager,w=c['resourceAudioMap'],I=c['resourceMusicMap'];if(i!==null&&i!==void 0x0?i:![])return i==='audio'?w['get'](g)['dom']:I['get'](g);else{if(w['has'](g))return w['get'](g)['dom'];else{if(I['has'](g))return I['get'](g);}}},'newAudio'(g,i='audio',c=![]){let w=new Audio(),I=/.mp3$/['test'](g)?g:'audio/'+g+'.mp3';w['src']=I;if(i==='audio'){var Q;(c||!((Q=oAudioManager['resourceAudioMap']['get'](g))!==null&&Q!==void 0x0&&Q['dom']))&&oAudioManager['resourceAudioMap']['set'](g,{'dom':w,'num':0x0,'lastPlayingInstance':null,'lastPlayingTime':-Infinity});}else(c||!oAudioManager['resourceMusicMap']['get'](g))&&oAudioManager['resourceMusicMap']['set'](g,w);return w;},'playAudio'(g,i=![],c=0x1,w=0x1){const I=oAudioManager,Q=I['resourceAudioMap'],k=I['__ticket__'];let f=Q['get'](g);const G=e=>{if(I['__ticket__']!==k)return;f['num']++,f['lastPlayingInstance']=e,f['lastPlayingTime']=oSym['Now'],e['playbackRate']=w,e['currentTime']=0x0,e['__originalVolume__']=c,e['volume']=c*$User['AudioEffectVolumePercent'],e['loop']=i,e['muted']=I['isAllResMuted'],!oS['isAllResPaused']&&e['play'](),I['playingAudioDomSet']['add'](e),!i&&e['addEventListener']('ended',function X(){f['num']--,I['playingAudioDomSet']['delete'](e),e=null;},{'once':!![]});};if(isNullish(g)){if(localStorage['JNG_DEV'])debugger;return;}for(let e of I['pausedDeletedAudio']){var z;((z=I['getDom'](g))===null||z===void 0x0?void 0x0:z['src'])==e&&(I['pausedDeletedAudio']['delete'](e),f['num']--);}if(f&&f['dom']){if(f['num']<I['maxSyncPlayBackNum']&&(!oSym['Timer']||!f['lastPlayingInstance']||Math['abs'](f['lastPlayingTime']-oSym['Now'])>0x14)){let X=f['dom']['cloneNode']();return G(X),X;}else return f['lastPlayingInstance'];}else{let F=I['newAudio'](g);f=Q['get'](g);let H=f['num']<I['maxSyncPlayBackNum'];if(H&&(!oSym['Timer']||!f['lastPlayingInstance']||Math['abs'](f['lastPlayingTime']-oSym['Now'])>0x14)){let W=f['dom']['cloneNode']();return G(W),W;}else return f['lastPlayingInstance'];}},'playMusic'(g=oAudioManager['curMusic'],i=!![],c=0x1){const w=oAudioManager,I=w['resourceMusicMap'],Q=I['get'](g);let k;if(w['curMusic']===g&&!Q['paused'])return;w['pauseMusic'](),w['curMusic']=g;const f=G=>{if(w['curMusic']!==g)return;G['playbackRate']=0x1,G['currentTime']=0x0,G['__originalVolume__']=c,G['volume']=c*$User['MusicVolumePercent'],G['loop']=i,G['muted']=w['isAllResMuted'],G['play']();};if(Q)return f(Q),Q;else{let G=w['newAudio'](g,'music',!![]);return f(G),G;}},'pauseAudio'(g,i=!![]){let c,w=oAudioManager,I=0x1;if(typeof g==='string'){I=0x0;let Q=/.mp3$/['test'](g)?g:'audio/'+g+'.mp3';for(let k of w['playingAudioDomSet']){k['src']['includes'](Q)&&(g=k);}}w['pausedDeletedAudio']['add'](g['src']);if(g instanceof Audio)c=g,g['readyState']===0x4?(g['pause'](),i&&(I?w['forcedPausedAudioSpecific']['add'](g):w['forcedPausedAudio']['add'](g['src']))):g['addEventListener']('canplaythrough',g['pause']['bind'](g),{'once':!![]});else g instanceof Promise&&g['then'](f=>{f['readyState']===0x4?(f['pause'](),i&&(I?w['forcedPausedAudioSpecific']['add'](f):w['forcedPausedAudio']['add'](f['src']))):f['addEventListener']('canplaythrough',f['pause']['bind'](f),{'once':!![]}),c=f;});return c;},'unpauseAudio'(g){let i,c=oAudioManager,w=0x1;if(typeof g==='string'){w=0x0;let I=/.mp3$/['test'](g)?g:'audio/'+g+'.mp3';for(let Q of c['playingAudioDomSet']){Q['src']['includes'](I)&&(g=Q);}}if(!c['playingAudioDomSet']['has'](g))return;c['pausedDeletedAudio']['delete'](g['src']);if(g instanceof Audio)i=g,g['readyState']===0x4?(g['play'](),w?c['forcedPausedAudioSpecific']['delete'](g):c['forcedPausedAudio']['delete'](g['src'])):g['addEventListener']('canplaythrough',g['pause']['bind'](g),{'once':!![]});else g instanceof Promise&&g['then'](k=>{k['readyState']===0x4?(k['play'](),w?c['forcedPausedAudioSpecific']['delete'](k):c['forcedPausedAudio']['delete'](k['src'])):k['addEventListener']('canplaythrough',k['pause']['bind'](k),{'once':!![]}),i=k;});return i;},'deleteAudio'(g='all'){const i=oAudioManager;let c,w=0x1;g!='all'&&typeof g==='string'&&(w=0x0,c=/.mp3$/['test'](g)?g:'audio/'+g+'.mp3');for(let I of i['playingAudioDomSet']){if(g=='all'||(c?I['src']['includes'](c):I===g)){i['pauseAudio'](I,![]),i['playingAudioDomSet']['delete'](I);if(w){if(i['forcedPausedAudioSpecific']['has'](I))i['forcedPausedAudioSpecific']['delete'](I);}else{if(i['forcedPausedAudio']['has'](I['src']))i['forcedPausedAudio']['delete'](I['src']);}}}g=='all'&&(i['forcedPausedAudioSpecific']['clear'](),i['forcedPausedAudio']['clear'](),i['pausedDeletedAudio']['clear'](),i['playingAudioDomSet']['clear']());},'pauseMusic'(){const g=oAudioManager,i=g['resourceMusicMap']['get'](g['curMusic']);return i&&(i['readyState']===0x4?i['pause']():i['addEventListener']('canplaythrough',i['pause']['bind'](i),{'once':!![]})),i;},'allResPaused'(){const g=oAudioManager;g['isAllResPaused']=!![];for(let i of g['playingAudioDomSet']){g['pauseAudio'](i,![]);}g['pauseMusic']();},'allResPauseCanceled'(){const g=oAudioManager;g['isAllResPaused']=![];for(let c of g['playingAudioDomSet']){if(!g['forcedPausedAudio']['has'](c['src'])&&!g['forcedPausedAudioSpecific']['has'](c))c['play']();}let i=g['getDom'](g['curMusic'],'music');i&&i['play']();},'allResMuted'(){const g=oAudioManager;g['isAllResMuted']=!![];for(let i of g['playingAudioDomSet']){i['muted']=!![];}g['curMusic']&&(g['resourceMusicMap']['get'](g['curMusic'])['muted']=!![]);},'allResMutedCanceled'(){const g=oAudioManager;g['isAllResMuted']=![];for(let i of g['playingAudioDomSet']){i['muted']=![];}g['curMusic']&&(g['resourceMusicMap']['get'](g['curMusic'])['muted']=![]);},'modifyAudioVolume'(g,i){var c;return i=(c=i)!==null&&c!==void 0x0?c:g['__originalVolume__'],g['__originalVolume__']=i,g['volume']=i*$User['AudioEffectVolumePercent'],g;},'modifyMusicVolume'(g){var i;const c=oAudioManager,w=c['resourceMusicMap']['get'](c['curMusic']);return g=(i=g)!==null&&i!==void 0x0?i:w['__originalVolume__'],w['__originalVolume__']=g,w['volume']=g*$User['MusicVolumePercent'],w;}},SelectModal=(g,c)=>{dispatchEvent(EVENT_EXITGAME),ClearEventListeners(window,'jng-event-startgame'),ClearEventListeners(window,'jng-event-endgame'),ClearEventListeners(window,'jng-event-exitgame'),oAudioManager['deleteAudio'](),oSelectionMap['_lastMusic_']=oS['LoadMusic']=oS['StartGameMusic']=null;let w=oS['GlobalVariables'],I=oS['SelfVariables'];for(let Q in w){window[Q]=w[Q];}oS['GlobalVariables']={};for(let k of I){oS[k]=void 0x0;}oDynamicPic['revokeGarbage'](),oP['Destroy'](),CancelShovel(),SetBlock($('loading')),SetHidden($('dCardList'),$('tGround'),$('dSelectCard'),$('dTop'),$('dMenu'),$('dNewPlant')),SetNone($('Menu'),$('shade'),$('SelectionMap'),$('labMap')),dSurface['style']['display']=g==='Service/index.js'||g==='index'&&c==='Service'?'block':'none',EDAll=EBody['replaceChild'](EDNewAll,EDAll),LoadModal(g,c);},LoadModal=(g,i='Level')=>{oS['Slots']=0xa,oS['EDAllScrollLeft']=0x0,delete oS['coolSpeed'];let c='modal/'+(/\w+?\/\w+?.js$/['test'](g)?g:i+'/'+g+'.js');oS['Lvl']=c['substring'](c['lastIndexOf']('/')+0x1,c['indexOf']('.js')),oS['LoadingStage']='LoadingScript',/blob/['test'](g)&&(c=g,oS['Lvl']='Fanmade',oS['OriginLvl']=c),oSym['Timer']&&oSym['Stop'](),oSym['Init'](async()=>{ClearChild($('JNG_PVZTR_Modal'));let w=await firstScreenLoadingScript(c,document['head']);w['id']='JNG_PVZTR_Modal';});},ResetGame=function(){oAudioManager['allResPauseCanceled'](),oSym['Start']();},PauseGame=function(){oAudioManager['allResPaused'](),oSym['Stop']();},RewriteGlobalVariables=function(g,i){for(let c in g){i?(!oS['GlobalVariables'][c]&&(oS['GlobalVariables'][c]=window[c]),window[c]=g[c]):!oS['GlobalVariables'][c]&&(oS['GlobalVariables'][c]=window[c],window[c]=g[c]);}},NewO=(g,i)=>{let c=i||function(){};return c['prototype']=g,Object['defineProperty'](c['prototype'],'constructor',{'value':c,'configurable':![],'enumerable':![]}),c;},InheritO=function(g,i,c={}){let w=function(){};w['prototype']=new g(),i&&Object['assign'](w['prototype'],i),Object['defineProperty'](w['prototype'],'constructor',{'value':w,'configurable':![],'enumerable':![]});for(let I in c){Object['defineProperty'](w,I,{'value':c[I],'enumerable':![]});}return w;},$SEql=(g,i)=>i[g]||i['default'],$SSml=function(g,i,c){let w=0x0,I=i['length'];while(w<I){if(g<i[w])break;w++;}return c[w];},$SSmlList=function(g,i){let c=g[0x0]-0x1,w=c,I=g[g['length']-0x1]+0x1,Q=0x0,k=new Int8Array(I-c);while(c<I){c>=g[Q]&&Q++,k[c-w]=i[Q],c++;}return[k,w,k['length']];},$SEqlSml=function(g,i,c){return g=Math['Clamp'](g,0x0,c-0x1),i[g];};